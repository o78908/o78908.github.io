<!doctype html><html itemscope lang=en-us itemtype=http://schema.org/WebPage><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=5"><meta name=theme-name content="hugoplate"><link rel="shortcut icon" href=/images/1_hu209dc01dac0d8d29161ee131376a931a_131805_96x0_resize_lanczos_3.png type=image/x-icon><link rel=icon href=/images/1_hu209dc01dac0d8d29161ee131376a931a_131805_96x0_resize_lanczos_3.png type=image/x-icon><link rel=icon type=image/png sizes=48x48 href=/images/1_hu209dc01dac0d8d29161ee131376a931a_131805_48x0_resize_lanczos_3.png><link rel=icon type=image/png sizes=96x96 href=/images/1_hu209dc01dac0d8d29161ee131376a931a_131805_96x0_resize_lanczos_3.png><link rel=apple-touch-icon sizes=144x144 href=/images/1_hu209dc01dac0d8d29161ee131376a931a_131805_144x0_resize_lanczos_3.png><link rel=manifest href=/manifest.webmanifest><meta name=msapplication-TileColor content="#ddd"><meta name=theme-color content="#ffffff"><base href=https://aimv.sidrlab.net/blog/2024/marketing_ds/><title>Marketing Data Science , material from Jody Tsao</title>
<meta name=keywords content="大數據分析,行銷資料科學"><meta name=description content="人工智慧行銷視覺實驗室"><meta name=author content="曹修源"><meta property="og:image" content="https://aimv.sidrlab.net/images/article_picture/dataAnalytics.jpg"><meta name=twitter:image content="https://aimv.sidrlab.net/images/article_picture/dataAnalytics.jpg"><meta name=twitter:card content="summary_large_image"><meta property="og:image:width" content="3000"><meta property="og:image:height" content="2000"><meta property="og:image:type" content="image/.jpg"><meta property="og:title" content="Marketing Data Science , material from Jody Tsao"><meta property="og:description" content="人工智慧行銷視覺實驗室"><meta property="og:type" content="website"><meta property="og:url" content="https://aimv.sidrlab.net/blog/2024/marketing_ds/"><meta name=twitter:title content="Marketing Data Science , material from Jody Tsao"><meta name=twitter:description content="人工智慧行銷視覺實驗室"><script>let indexURL="https://aimv.sidrlab.net/searchindex.json",includeSectionsInSearch=["blog"],search_no_results="No results for",search_initial_message="Type something to search.."</script><meta http-equiv=x-dns-prefetch-control content="on"><link rel=preconnect href=https://use.fontawesome.com crossorigin><link rel=preconnect href=//cdnjs.cloudflare.com><link rel=preconnect href=//www.googletagmanager.com><link rel=preconnect href=//www.google-analytics.com><link rel=dns-prefetch href=https://use.fontawesome.com><link rel=dns-prefetch href=//ajax.googleapis.com><link rel=dns-prefetch href=//cdnjs.cloudflare.com><link rel=dns-prefetch href=//www.googletagmanager.com><link rel=dns-prefetch href=//www.google-analytics.com><link rel=dns-prefetch href=//fonts.googleapis.com><link rel=dns-prefetch href=//connect.facebook.net><link rel=dns-prefetch href=//platform.linkedin.com><link rel=dns-prefetch href=//platform.twitter.com><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Heebo:wght@400;600&family=Signika:wght@500;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script><link href="/css/style.min.3d37cc8252f59eb77fea8ededebe98a17abfd8ce00caa2bfea492e41a004afbc.css" integrity="sha256-PTfMglL1nrd/6o7e3r6YoXq/2M4AyqK/6kkuQaAEr7w=" rel=stylesheet><link defer async rel=stylesheet href="/css/style-lazy.min.5d85e889fd5f5b28f9387aeade847fcb0a66d76a99a985ab4cdae3d37cf21557.css" integrity="sha256-XYXoif1fWyj5OHrq3oR/ywpm12qZqYWrTNrj03zyFVc=" media=print onload='this.media="all",this.onload=null'><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8682919340868040" crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-2N8YHX8D92"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-2N8YHX8D92")</script></head><body><header class="header sticky top-0 z-30"><nav class="navbar container"><div class=order-0><a class="navbar-brand block" href=/><img fetchpriority=high decoding=async class="img logo-light" width=240 height=48 src=/images/1_hu209dc01dac0d8d29161ee131376a931a_131805_480x0_resize_q80_h2_lanczos_3.webp alt=人工智慧行銷視覺實驗室 onerror='this.onerror=null,this.src="/images/1_hu209dc01dac0d8d29161ee131376a931a_131805_480x0_resize_lanczos_3.png"'>
<img fetchpriority=high decoding=async class="img logo-dark" width=240 height=48 src=/images/1_hu209dc01dac0d8d29161ee131376a931a_131805_480x0_resize_q80_h2_lanczos_3.webp alt=人工智慧行銷視覺實驗室 onerror='this.onerror=null,this.src="/images/1_hu209dc01dac0d8d29161ee131376a931a_131805_480x0_resize_lanczos_3.png"'></a></div><input id=nav-toggle type=checkbox class=hidden>
<label for=nav-toggle class="order-3 cursor-pointer flex items-center lg:hidden text-dark dark:text-white lg:order-1"><svg id="show-button" class="h-6 fill-current block" viewBox="0 0 20 20"><title>Menu Open</title><path d="M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0V0z"/></svg><svg id="hide-button" class="h-6 fill-current hidden" viewBox="0 0 20 20"><title>Menu Close</title><polygon points="11 9 22 9 22 11 11 11 11 22 9 22 9 11 -2 11 -2 9 9 9 9 -2 11 -2" transform="rotate(45 10 10)"/></svg></label><ul id=nav-menu class="navbar-nav order-3 hidden lg:flex w-full pb-6 lg:order-1 lg:w-auto lg:space-x-2 lg:pb-0 xl:space-x-8"><li class=nav-item><a class=nav-link href=/>首頁</a></li><li class=nav-item><a class=nav-link href=/authors/>關於我們</a></li><li class=nav-item><a class=nav-link href=/blog/>文章總覽</a></li><li class="nav-item nav-dropdown group relative"><span class="nav-link
inline-flex items-center">其他資訊<svg class="h-4 w-4 fill-current" viewBox="0 0 20 20"><path d="M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"/></svg></span><ul class="nav-dropdown-list lg:group-hover:visible lg:group-hover:opacity-100"><li class=nav-dropdown-item><a class=nav-dropdown-link href=/chatbot/>SIDRLAB ChatBot</a></li><li class=nav-dropdown-item><a class=nav-dropdown-link href=/categories/>文章分類</a></li><li class=nav-dropdown-item><a class=nav-dropdown-link href=/contact/>聯絡我們</a></li></ul></li><li class="mt-4 inline-block lg:hidden"><a class="btn btn-outline-primary btn-sm" href=https://www.sidrlab.net/>前往SIDR LAB網站</a></li></ul><div class="order-1 ml-auto flex items-center md:order-2 lg:ml-0"><button aria-label=search class="border-border text-dark hover:text-primary dark:border-darkmode-border mr-5 inline-block border-r pr-5 text-xl dark:text-white dark:hover:text-darkmode-primary" data-target=search-modal>
<i class="fa-solid fa-search"></i></button><div class="theme-switcher mr-5"><input id=theme-switcher data-theme-switcher type=checkbox>
<label for=theme-switcher><span class=sr-only>theme switcher</span>
<span><svg class="absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 z-10 opacity-100 dark:opacity-0" viewBox="0 0 56 56" fill="#fff" height="16" width="16"><path d="M30 4.6c0-1-.9-2-2-2a2 2 0 00-2 2v5c0 1 .9 2 2 2s2-1 2-2zm9.6 9a2 2 0 000 2.8c.8.8 2 .8 2.9.0L46 13a2 2 0 000-2.9 2 2 0 00-3 0zm-26 2.8c.7.8 2 .8 2.8.0.8-.7.8-2 0-2.9L13 10c-.7-.7-2-.8-2.9.0-.7.8-.7 2.1.0 3zM28 16A12 12 0 0016 28a12 12 0 0012 12 12 12 0 0012-12A12 12 0 0028 16zm23.3 14c1.1.0 2-.9 2-2s-.9-2-2-2h-4.9a2 2 0 00-2 2c0 1.1 1 2 2 2zM4.7 26a2 2 0 00-2 2c0 1.1.9 2 2 2h4.9c1 0 2-.9 2-2s-1-2-2-2zm37.8 13.6a2 2 0 00-3 0 2 2 0 000 2.9l3.6 3.5a2 2 0 002.9.0c.8-.8.8-2.1.0-3zM10 43.1a2 2 0 000 2.9c.8.7 2.1.8 3 0l3.4-3.5c.8-.8.8-2.1.0-2.9s-2-.8-2.9.0zm20 3.4c0-1.1-.9-2-2-2a2 2 0 00-2 2v4.9c0 1 .9 2 2 2s2-1 2-2z"/></svg><svg class="absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 z-10 opacity-0 dark:opacity-100" viewBox="0 0 24 24" fill="none" height="16" width="16"><path fill="#000" fill-rule="evenodd" clip-rule="evenodd" d="M8.2 2.2c1-.4 2 .6 1.6 1.5-1 3-.4 6.4 1.8 8.7a8.4 8.4.0 008.7 1.8c1-.3 2 .5 1.5 1.5v.1A10.3 10.3.0 0112.4 22 10.3 10.3.0 013.2 6.7c1-2 2.9-3.5 4.9-4.4z"/></svg></span></label></div><script>var themeSwitch,darkMode=!1;window.matchMedia("(prefers-color-scheme: dark)").matches&&(darkMode=!0),localStorage.getItem("theme")==="dark"?darkMode=!0:localStorage.getItem("theme")==="light"&&(darkMode=!1),darkMode&&document.documentElement.classList.toggle("dark"),themeSwitch=document.querySelectorAll("[data-theme-switcher]"),document.addEventListener("DOMContentLoaded",()=>{[].forEach.call(themeSwitch,function(e){e.checked=!!darkMode,e.addEventListener("click",()=>{document.documentElement.classList.toggle("dark"),localStorage.setItem("theme",document.documentElement.classList.contains("dark")?"dark":"light")})})})</script><a href=https://www.sidrlab.net/ class="btn btn-outline-primary btn-sm hidden lg:inline-block">前往SIDR LAB網站</a></div></nav></header><div class=search-modal aria-hidden=true style=--color-primary:#121212><div data-target=close-search-modal class=search-modal-overlay></div><div class=search-wrapper data-image=true data-description=true data-tags=true data-categories=true><div class=search-wrapper-header><label for=search-modal-input style=margin-top:-1px><span class=sr-only>search icon</span>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" height="18" width="18" class="search-icon" data-type="search"><path fill="currentcolor" d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8.0 45.3s-32.8 12.5-45.3.0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9.0 208S93.1.0 208 0 416 93.1 416 208zM208 352a144 144 0 100-288 144 144 0 100 288z"/></svg>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" height="18" width="18" class="search-reset" data-type="reset"><path fill="currentcolor" d="M256 512A256 256 0 10256 0a256 256 0 100 512zM175 175c9.4-9.4 24.6-9.4 33.9.0l47 47 47-47c9.4-9.4 24.6-9.4 33.9.0s9.4 24.6.0 33.9l-47 47 47 47c9.4 9.4 9.4 24.6.0 33.9s-24.6 9.4-33.9.0l-47-47-47 47c-9.4 9.4-24.6 9.4-33.9.0s-9.4-24.6.0-33.9l47-47-47-47c-9.4-9.4-9.4-24.6.0-33.9z"/></svg>
</label><input id=search-modal-input type=text data-search-input autocomplete=off aria-label=Search placeholder="Search Post..."></div><div class=search-wrapper-body><div class=search-result data-search-result></div><span class=search-result-empty>Type something to search..</span></div><div class=search-wrapper-footer><span><kbd><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentcolor" viewBox="0 0 16 16"><path d="M3.204 11h9.592L8 5.519 3.204 11zm-.753-.659 4.796-5.48a1 1 0 011.506.0l4.796 5.48c.566.647.106 1.659-.753 1.659H3.204a1 1 0 01-.753-1.659z"/></svg>
</kbd><kbd><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentcolor" style="margin-top:1px" viewBox="0 0 16 16"><path d="M3.204 5h9.592L8 10.481 3.204 5zm-.753.659 4.796 5.48a1 1 0 001.506.0l4.796-5.48c.566-.647.106-1.659-.753-1.659H3.204a1 1 0 00-.753 1.659z"/></svg>
</kbd>to navigate
</span><span><kbd><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentcolor" style="display:inline-block" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M14.5 1.5a.5.5.0 01.5.5v4.8a2.5 2.5.0 01-2.5 2.5H2.707l3.347 3.346a.5.5.0 01-.708.708l-4.2-4.2a.5.5.0 010-.708l4-4a.5.5.0 11.708.708L2.707 8.3H12.5A1.5 1.5.0 0014 6.8V2a.5.5.0 01.5-.5z"/></svg>
</kbd>to select
</span><span class=search-result-info></span>
<span data-target=close-search-modal><kbd>ESC</kbd> to close</span></div></div></div><main><link href=https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css rel=stylesheet><section class="section pt-7"><div class=container><div class="row justify-center"><article class=lg:col-10><div class="mb-10 img-responsive"><picture><source srcset=/images/article_picture/dataAnalytics_hubd510a47a29ee5300d2a8fbe6dddf091_571474_545x0_resize_q80_h2_lanczos.webp media="(max-width: 575px)"><source srcset=/images/article_picture/dataAnalytics_hubd510a47a29ee5300d2a8fbe6dddf091_571474_600x0_resize_q80_h2_lanczos.webp media="(max-width: 767px)"><source srcset=/images/article_picture/dataAnalytics_hubd510a47a29ee5300d2a8fbe6dddf091_571474_700x0_resize_q80_h2_lanczos.webp media="(max-width: 991px)"><source srcset=/images/article_picture/dataAnalytics_hubd510a47a29ee5300d2a8fbe6dddf091_571474_1110x0_resize_q80_h2_lanczos.webp><img loading=lazy decoding=async src=/images/article_picture/dataAnalytics_hubd510a47a29ee5300d2a8fbe6dddf091_571474_1110x0_resize_q80_lanczos.jpg class="rounded img-responsive img" alt="Marketing Data Science" width=3000 height=2000></picture></div><h1 class="h2 mb-4">Marketing Data Science</h1><ul class=mb-4><li class="mr-4 inline-block"><a href=/authors/%E6%9B%B9%E4%BF%AE%E6%BA%90/><i class="fa-regular fa-circle-user mr-2"></i>曹修源</a></li><li class="mr-4 inline-block"><i class="fa-regular fa-folder mr-2"></i>
<a href=/categories/application/>Application,
</a><a href=/categories/dataanalytics/>Data analytics</a></li><li class="mr-4 inline-block"><i class="fa-regular fa-clock mr-2"></i>
July 29, 2024</li></ul><div class="content mb-10"><details open class="table-of-content blog"><summary>Table of Contents</summary><nav id=TableOfContents><ol><li><a href=#本堂課程教材>本堂課程教材</a></li><li><a href=#20240221>20240221</a><ol><li><a href=#python程式碼>python程式碼</a></li><li><a href=#r語言程式碼>R語言程式碼</a></li></ol></li><li><a href=#20240229>20240229</a><ol><li><a href=#python程式碼-1>Python程式碼</a></li><li><a href=#r語言程式碼-1>R語言程式碼</a></li></ol></li><li><a href=#20240416>20240416</a></li><li><a href=#20240424-對應分析>20240424 對應分析</a><ol><li><a href=#python程式碼請自行確認是否能運作>Python程式碼(請自行確認是否能運作)</a></li><li><a href=#r-語言程式碼>R 語言程式碼</a></li></ol></li><li><a href=#20240430>20240430</a><ol><li><a href=#cluster_k-means-r語言程式碼>Cluster_K-Means R語言程式碼</a></li><li><a href=#customer-segmentation-r語言程式碼>Customer Segmentation R語言程式碼</a></li><li><a href=#cluster_k-means-python程式碼請自行確認是否能運作>Cluster_K-Means Python程式碼(請自行確認是否能運作)</a></li><li><a href=#customer-segmentation-python程式碼請自行確認是否能運作>Customer Segmentation Python程式碼(請自行確認是否能運作)</a></li></ol></li><li><a href=#20240508-association-rule-關聯法則-啤酒與尿布>20240508 Association Rule (關聯法則 啤酒與尿布)</a><ol><li><a href=#關聯法則-r語言程式碼>關聯法則 R語言程式碼</a></li><li><a href=#關聯法則-python程式碼請自行確認是否能運作>關聯法則 Python程式碼(請自行確認是否能運作)</a></li></ol></li><li><a href=#20240511-decision-tree>20240511 Decision Tree</a><ol><li><a href=#decision-tree-r語言程式碼>Decision Tree R語言程式碼</a></li><li><a href=#decision-tree-python程式碼請自行確認是否能運作>Decision Tree Python程式碼(請自行確認是否能運作)</a></li></ol></li><li><a href=#20240605-seo>20240605 SEO</a></li></ol></nav></details><h2 id=本堂課程教材>本堂課程教材</h2><script src=/js/pdf-js/build/pdf.js></script><style>#embed-pdf-container{position:relative;width:100%;height:auto;min-height:20vh}.pdf-canvas{border:1px solid #000;direction:ltr;width:100%;height:auto;display:none}#the-canvas{border:1px solid #000;direction:ltr;width:100%;height:auto;display:none}.pdf-loadingWrapper{display:none;justify-content:center;align-items:center;width:100%;height:350px}.pdf-loading{display:inline-block;width:50px;height:50px;border:3px solid #d2d0d0;border-radius:50%;border-top-color:#383838;animation:spin 1s ease-in-out infinite;-webkit-animation:spin 1s ease-in-out infinite}#overlayText{word-wrap:break-word;display:grid;justify-content:end}#overlayText a{position:relative;top:10px;right:4px;color:#000;margin:auto;background-color:#eee;padding:.3em 1em;border:solid 2px;border-radius:12px;border-color:#00000030;text-decoration:none}#overlayText svg{height:clamp(1em,2vw,1.4em);width:clamp(1em,2vw,1.4em)}@keyframes spin{to{-webkit-transform:rotate(360deg)}}@-webkit-keyframes spin{to{-webkit-transform:rotate(360deg)}}</style><div class=embed-pdf-container id=embed-pdf-container-f6c5165b><div class=pdf-loadingWrapper id=pdf-loadingWrapper-f6c5165b><div class=pdf-loading id=pdf-loading-f6c5165b></div></div><div id=overlayText><a href=/files/%e5%a4%a7%e6%95%b8%e6%93%9a%e5%88%86%e6%9e%90_2023_01.pdf aria-label=Download download><svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18"><path d="M9 13c.3.0.5-.1.7-.3L15.4 7 14 5.6l-4 4V1H8v8.6l-4-4L2.6 7l5.7 5.7c.2.2.4.3.7.3zm-7 2h14v2H2z"/></svg></a></div><canvas class=pdf-canvas id=pdf-canvas-f6c5165b></canvas></div><div class=pdf-paginator id=pdf-paginator-f6c5165b><button id=pdf-prev-f6c5165b>上一頁 </button>&nbsp;&nbsp;
<button id=pdf-next-f6c5165b>下一頁 </button> &nbsp; &nbsp;
<span><span class=pdf-pagenum id=pdf-pagenum-f6c5165b></span> / <span class=pdf-pagecount id=pdf-pagecount-f6c5165b></span>
</span>&nbsp;
<a class=pdf-source id=pdf-source-f6c5165b href=/files/%e5%a4%a7%e6%95%b8%e6%93%9a%e5%88%86%e6%9e%90_2023_01.pdf>[ 檢視PDF全文 ]</a></div><noscript>View the PDF file <a class=pdf-source id=pdf-source-noscript-f6c5165b href=/files/%e5%a4%a7%e6%95%b8%e6%93%9a%e5%88%86%e6%9e%90_2023_01.pdf>here</a>.</noscript><script type=text/javascript>(function(){c="/files/大數據分析_2023_01.pdf",u=""==="true",l=""==="true",h=parseInt("")||1,s=window["pdfjs-dist/build/pdf"],s.GlobalWorkerOptions.workerSrc==""&&(s.GlobalWorkerOptions.workerSrc="https://aimv.sidrlab.net/js/pdf-js/build/pdf.worker.js");var s,c,l,u,h,n=null,e=h,i=!1,o=null,b=3,t=document.getElementById("pdf-canvas-f6c5165b"),m=t.getContext("2d"),f=document.getElementById("pdf-paginator-f6c5165b"),r=document.getElementById("pdf-loadingWrapper-f6c5165b");v(),g();function a(e){i=!0,n.getPage(e).then(function(e){var s,r,n=e.getViewport({scale:b});t.height=n.height,t.width=n.width,s={canvasContext:m,viewport:n},r=e.render(s),r.promise.then(function(){i=!1,p(),o!==null&&(a(o),o=null)})}),document.getElementById("pdf-pagenum-f6c5165b").textContent=e}function p(){r.style.display="none",t.style.display="block"}function g(){if(l)return;r.style.display="flex",t.style.display="none"}function v(){if(u)return;f.style.display="block"}function d(e){i?o=e:a(e)}function j(){if(e<=1)return;e--,d(e)}document.getElementById("pdf-prev-f6c5165b").addEventListener("click",j);function y(){if(e>=n.numPages)return;e++,d(e)}document.getElementById("pdf-next-f6c5165b").addEventListener("click",y),s.getDocument(c).promise.then(function(t){n=t;var s=n.numPages;document.getElementById("pdf-pagecount-f6c5165b").textContent=s,e>s&&(e=s),a(e)})})()</script><h2 id=20240221>20240221</h2><p>(1)Service Quality Scale (SERVQUAL)
Parasuraman,A.;Berry,Leonard L.;Zeithaml,Valarie A., “SERVQUAL: A Multiple-Item Scale For Measuring Consumer Perceptions of Service Quality”, Journal of Retailing, 1988, 64, 1, 12-40.</p><p>服務品質衡量量表為SERVQUAL和SERVPERF最為普遍。兩者當中，又以SERVQUAL量表最常被使用。
SERVQUAL量表是由Parasuraman, Berry和Zeitham三位學者於1988年提出，用於衡量服務品質，也是後續許多學者研究基礎。</p><p>針對服務品質概論(PZB模式)中十種屬性加以抽樣、驗證及重新定義成五個構面：
可靠性(Reliability)是能夠準確可靠地執行承諾的服務；
反應性(Responsiveness)是願意幫助顧客並即時提供服務；
同理心(Empathy)是關注給予客戶關懷和客製化服務；
保證性(Assurance)是員工的知識和禮貌及使人產生信任和信心的能力；
有形性(Tangibility)是實際設施、旅店設備以及服務人員等。</p><p>(2) 服務品質網路問卷設計，範例
<a href=https://forms.gle/FtoEuFZGsyxzwqt37 target=_blank>https://forms.gle/FtoEuFZGsyxzwqt37</a>
<a href=https://forms.gle/ZdHJeuh2xYm2J7YG6 target=_blank>https://forms.gle/ZdHJeuh2xYm2J7YG6</a></p><p>圖書館服務品質問卷範例
LibQual</p><p>旅宿業館服務品質問卷範例
LQI</p><p>(3) Importance - Performacne Analysis
Martilla, J.A. and James, J.C. (1977) Importance-Performance Analysis. Journal of Marketing, 41, 77-79.
如何分析 ? ( 範例NCHUMTSQ_OK.xlsx)</p><p><strong><a href="https://docs.google.com/spreadsheets/d/1Re3qAAdh1D_3YRMPZFpxB0eELnlNt79b/edit?usp=sharing&amp;ouid=112055382774069462953&amp;rtpof=true&amp;sd=true" target=_blank>本週資料集請點我</a></strong></p><h3 id=python程式碼>python程式碼</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> pandas <span style=color:#66d9ef>as</span> pd
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> numpy <span style=color:#66d9ef>as</span> np
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> plotnine <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> matplotlib.pyplot <span style=color:#66d9ef>as</span> plt
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 讀取 Excel 文件</span>
</span></span><span style=display:flex><span>data <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>read_excel(<span style=color:#e6db74>&#34;NCHUMTSQ.xlsx&#34;</span>, sheet_name<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 提取奇數列和偶數列數據</span>
</span></span><span style=display:flex><span>col_odd <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>arange(len(data<span style=color:#f92672>.</span>columns)) <span style=color:#f92672>%</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>data_col_odd <span style=color:#f92672>=</span> data<span style=color:#f92672>.</span>iloc[:, col_odd]
</span></span><span style=display:flex><span>data_col_satisfaction <span style=color:#f92672>=</span> data_col_odd<span style=color:#f92672>.</span>iloc[:, <span style=color:#ae81ff>1</span>:]
</span></span><span style=display:flex><span>data_col_importance <span style=color:#f92672>=</span> data<span style=color:#f92672>.</span>iloc[:, <span style=color:#f92672>~</span>col_odd]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Calculate the mean of each column in the satisfaction DataFrame</span>
</span></span><span style=display:flex><span>satisfaction_df_mean <span style=color:#f92672>=</span> data_col_satisfaction<span style=color:#f92672>.</span>mean(axis<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Slice the means for different dimensions</span>
</span></span><span style=display:flex><span>satisfaction_df_Tangibility <span style=color:#f92672>=</span> satisfaction_df_mean[<span style=color:#ae81ff>0</span>:<span style=color:#ae81ff>4</span>]
</span></span><span style=display:flex><span>satisfaction_df_Assurance <span style=color:#f92672>=</span> satisfaction_df_mean[<span style=color:#ae81ff>4</span>:<span style=color:#ae81ff>9</span>]
</span></span><span style=display:flex><span>satisfaction_df_Empathy <span style=color:#f92672>=</span> satisfaction_df_mean[<span style=color:#ae81ff>9</span>:<span style=color:#ae81ff>14</span>]
</span></span><span style=display:flex><span>satisfaction_df_Responsiveness <span style=color:#f92672>=</span> satisfaction_df_mean[<span style=color:#ae81ff>14</span>:<span style=color:#ae81ff>18</span>]
</span></span><span style=display:flex><span>satisfaction_df_Reliability <span style=color:#f92672>=</span> satisfaction_df_mean[<span style=color:#ae81ff>18</span>:<span style=color:#ae81ff>22</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Calculate the mean for each dimension</span>
</span></span><span style=display:flex><span>satisfaction_df_dim <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Tangibility&#39;</span>: satisfaction_df_Tangibility<span style=color:#f92672>.</span>mean(),
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Assurance&#39;</span>: satisfaction_df_Assurance<span style=color:#f92672>.</span>mean(),
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Empathy&#39;</span>: satisfaction_df_Empathy<span style=color:#f92672>.</span>mean(),
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Responsiveness&#39;</span>: satisfaction_df_Responsiveness<span style=color:#f92672>.</span>mean(),
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Reliability&#39;</span>: satisfaction_df_Reliability<span style=color:#f92672>.</span>mean()
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Calculate the mean of each column in the importance DataFrame</span>
</span></span><span style=display:flex><span>importance_df_mean <span style=color:#f92672>=</span> data_col_importance<span style=color:#f92672>.</span>mean(axis<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Slice the means for different dimensions</span>
</span></span><span style=display:flex><span>importance_df_Tangibility <span style=color:#f92672>=</span> importance_df_mean[<span style=color:#ae81ff>0</span>:<span style=color:#ae81ff>4</span>]
</span></span><span style=display:flex><span>importance_df_Assurance <span style=color:#f92672>=</span> importance_df_mean[<span style=color:#ae81ff>4</span>:<span style=color:#ae81ff>9</span>]
</span></span><span style=display:flex><span>importance_df_Empathy <span style=color:#f92672>=</span> importance_df_mean[<span style=color:#ae81ff>9</span>:<span style=color:#ae81ff>14</span>]
</span></span><span style=display:flex><span>importance_df_Responsiveness <span style=color:#f92672>=</span> importance_df_mean[<span style=color:#ae81ff>14</span>:<span style=color:#ae81ff>18</span>]
</span></span><span style=display:flex><span>importance_df_Reliability <span style=color:#f92672>=</span> importance_df_mean[<span style=color:#ae81ff>18</span>:<span style=color:#ae81ff>22</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Calculate the mean for each dimension</span>
</span></span><span style=display:flex><span>importance_df_dim <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Tangibility&#39;</span>: importance_df_Tangibility<span style=color:#f92672>.</span>mean(),
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Assurance&#39;</span>: importance_df_Assurance<span style=color:#f92672>.</span>mean(),
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Empathy&#39;</span>: importance_df_Empathy<span style=color:#f92672>.</span>mean(),
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Responsiveness&#39;</span>: importance_df_Responsiveness<span style=color:#f92672>.</span>mean(),
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Reliability&#39;</span>: importance_df_Reliability<span style=color:#f92672>.</span>mean()
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Attribute_df_dim <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#39;Tangibility&#39;</span>: <span style=color:#e6db74>&#39;Tangibility&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Assurance&#39;</span>: <span style=color:#e6db74>&#39;Assurance&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Empathy&#39;</span>: <span style=color:#e6db74>&#39;Empathy&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Responsiveness&#39;</span>: <span style=color:#e6db74>&#39;Responsiveness&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Reliability&#39;</span>: <span style=color:#e6db74>&#39;Reliability&#39;</span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Print the results</span>
</span></span><span style=display:flex><span>print(satisfaction_df_dim)
</span></span><span style=display:flex><span>print(importance_df_dim)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 創建 IPA 數據框</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#ipa_df = pd.DataFrame({&#39;importance_df_dim&#39;: importance_df_dim, &#39;satisfaction_df_dim&#39;: satisfaction_df_dim})</span>
</span></span><span style=display:flex><span>df <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>DataFrame(
</span></span><span style=display:flex><span>  { <span style=color:#e6db74>&#39;Attribute&#39;</span>: Attribute_df_dim,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Importance&#39;</span>: importance_df_dim,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;Performance&#39;</span>: satisfaction_df_dim})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Plot</span>
</span></span><span style=display:flex><span>fig, ax <span style=color:#f92672>=</span> plt<span style=color:#f92672>.</span>subplots()
</span></span><span style=display:flex><span><span style=color:#75715e>#df.plot(kind=&#39;scatter&#39;, x=&#39;Importance&#39;, y=&#39;Performance&#39;, ax=ax)</span>
</span></span><span style=display:flex><span>df<span style=color:#f92672>.</span>plot(kind<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;scatter&#39;</span>, x<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Performance&#39;</span>, y<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Importance&#39;</span>, ax<span style=color:#f92672>=</span>ax)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Label points in the scatter plot</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i, txt <span style=color:#f92672>in</span> enumerate(df<span style=color:#f92672>.</span>Attribute):
</span></span><span style=display:flex><span>    ax<span style=color:#f92672>.</span>annotate(txt, (df<span style=color:#f92672>.</span>Performance[i],df<span style=color:#f92672>.</span>Importance[i] ))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Set chart title and labels</span>
</span></span><span style=display:flex><span>ax<span style=color:#f92672>.</span>set_title(<span style=color:#e6db74>&#39;Importance-Performance Analysis&#39;</span>)
</span></span><span style=display:flex><span>ax<span style=color:#f92672>.</span>set_xlabel(<span style=color:#e6db74>&#39;Performance&#39;</span>)
</span></span><span style=display:flex><span>ax<span style=color:#f92672>.</span>set_ylabel(<span style=color:#e6db74>&#39;Importance&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Draw mean lines for importance and performance</span>
</span></span><span style=display:flex><span>mean_importance <span style=color:#f92672>=</span> df[<span style=color:#e6db74>&#39;Importance&#39;</span>]<span style=color:#f92672>.</span>mean()
</span></span><span style=display:flex><span>mean_performance <span style=color:#f92672>=</span> df[<span style=color:#e6db74>&#39;Performance&#39;</span>]<span style=color:#f92672>.</span>mean()
</span></span><span style=display:flex><span>ax<span style=color:#f92672>.</span>axvline(x<span style=color:#f92672>=</span>mean_performance, coloR<span style=color:#e6db74>&#39;r&#39;</span>, linestyle<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;--&#39;</span>)
</span></span><span style=display:flex><span>ax<span style=color:#f92672>.</span>axhline(y<span style=color:#f92672>=</span>mean_importance, coloR<span style=color:#e6db74>&#39;r&#39;</span>, linestyle<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;--&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Show plot</span>
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>show()
</span></span></code></pre></div><h3 id=r語言程式碼>R語言程式碼</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-R data-lang=R><span style=display:flex><span><span style=color:#75715e>#-----------------------------------------------</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#install packages required </span>
</span></span><span style=display:flex><span><span style=color:#75715e>#load package via library()</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#-----------------------------------------------</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(xlsx)
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(dplyr)
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(webshot)
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(htmlwidgets)
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(igraph)
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(ggraph)
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(widyr)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(ggplot2)
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(ggrepel)
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(plotly)
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(showtext)
</span></span><span style=display:flex><span><span style=color:#75715e>#------------set working directory ------------</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#setwd(&#34;c://Koong//csv//SERVQUAL_IPA&#34;)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#-----------------------------------------------</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#-----Read the first worksheet in the file input.xlsx.</span>
</span></span><span style=display:flex><span>data <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>read.xlsx</span>(<span style=color:#e6db74>&#34;NCHUMTSQ.xlsx&#34;</span>, sheetIndex <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span><span style=color:#75715e>#---------------------------------------------------</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#head(data)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#head(data[1:3,1:2])</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#colnames(data)[2]</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#---------------------------------------------------</span>
</span></span><span style=display:flex><span>col_odd <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>seq_len</span>(<span style=color:#a6e22e>ncol</span>(data)) <span style=color:#f92672>%%</span> <span style=color:#ae81ff>2</span>              <span style=color:#75715e># Create column indicator</span>
</span></span><span style=display:flex><span>col_odd                                          <span style=color:#75715e># Print column indicator</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#oddfiled &lt;- col_odd == 1</span>
</span></span><span style=display:flex><span>data_col_odd <span style=color:#f92672>&lt;-</span> data[ , col_odd <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span>]            <span style=color:#75715e># Subset odd columns</span>
</span></span><span style=display:flex><span>data_col_odd           
</span></span><span style=display:flex><span><span style=color:#75715e># Print odd columns</span>
</span></span><span style=display:flex><span>data_col_satisfaction <span style=color:#f92672>&lt;-</span> data_col_odd[,<span style=color:#ae81ff>-1</span>]
</span></span><span style=display:flex><span>data_col_satisfaction
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>data_col_importance <span style=color:#f92672>&lt;-</span> data[ , col_odd <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>]            <span style=color:#75715e># Subset even columns</span>
</span></span><span style=display:flex><span>data_col_importance                                     <span style=color:#75715e># Print even columns</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>satisfaction_df <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>data.frame</span>(data_col_satisfaction)
</span></span><span style=display:flex><span>satisfaction_df_mean <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>colMeans</span>(satisfaction_df) 
</span></span><span style=display:flex><span><span style=color:#75715e>#satisfaction_df_mean &lt;- colMeans(satisfaction_df[sapply(satisfaction_df, is.numeric)]) </span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>satisfaction_df_Tangibility <span style=color:#f92672>&lt;-</span> satisfaction_df_mean[1<span style=color:#f92672>:</span><span style=color:#ae81ff>4</span>]
</span></span><span style=display:flex><span>satisfaction_df_Assurance <span style=color:#f92672>&lt;-</span> satisfaction_df_mean[5<span style=color:#f92672>:</span><span style=color:#ae81ff>9</span>]
</span></span><span style=display:flex><span>satisfaction_df_Empathy <span style=color:#f92672>&lt;-</span> satisfaction_df_mean[10<span style=color:#f92672>:</span><span style=color:#ae81ff>14</span>]
</span></span><span style=display:flex><span>satisfaction_df_Responseness <span style=color:#f92672>&lt;-</span> satisfaction_df_mean[15<span style=color:#f92672>:</span><span style=color:#ae81ff>18</span>]
</span></span><span style=display:flex><span>satisfaction_df_Reliability <span style=color:#f92672>&lt;-</span> satisfaction_df_mean[19<span style=color:#f92672>:</span><span style=color:#ae81ff>22</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>satisfaction_df_dim <span style=color:#f92672>&lt;-</span> 
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>c</span>(Tangibility<span style=color:#f92672>=</span><span style=color:#a6e22e>mean</span>(satisfaction_df_Tangibility),
</span></span><span style=display:flex><span>    Assurance<span style=color:#f92672>=</span><span style=color:#a6e22e>mean</span>(satisfaction_df_Assurance),
</span></span><span style=display:flex><span>    Empathy<span style=color:#f92672>=</span><span style=color:#a6e22e>mean</span>(satisfaction_df_Empathy),
</span></span><span style=display:flex><span>    Responseness<span style=color:#f92672>=</span><span style=color:#a6e22e>mean</span>(satisfaction_df_Responseness),
</span></span><span style=display:flex><span>    Reliability<span style=color:#f92672>=</span><span style=color:#a6e22e>mean</span>(satisfaction_df_Reliability))
</span></span><span style=display:flex><span><span style=color:#75715e>#-------Commonly used statstics function -------------------</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#mean(duration)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#median(duration) </span>
</span></span><span style=display:flex><span><span style=color:#75715e>#quantile(duration)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#boxplot(duration, horizontal=TRUE)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#var(duration)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#sd(duration)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#https://methodenlehre.github.io/SGSCLM-R-course/index.html</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#----------------------------------------------------------</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>importance_df <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>data.frame</span>(data_col_importance)
</span></span><span style=display:flex><span>importance_df_mean <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>colMeans</span>(importance_df) 
</span></span><span style=display:flex><span><span style=color:#75715e>#importance_df_mean &lt;- colMeans(importance_df[sapply(importance_df, is.numeric)]) </span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>importance_df_Tangibility <span style=color:#f92672>&lt;-</span> importance_df_mean[1<span style=color:#f92672>:</span><span style=color:#ae81ff>4</span>]
</span></span><span style=display:flex><span>importance_df_Assurance <span style=color:#f92672>&lt;-</span> importance_df_mean[5<span style=color:#f92672>:</span><span style=color:#ae81ff>9</span>]
</span></span><span style=display:flex><span>importance_df_Empathy <span style=color:#f92672>&lt;-</span> importance_df_mean[10<span style=color:#f92672>:</span><span style=color:#ae81ff>14</span>]
</span></span><span style=display:flex><span>importance_df_Responseness <span style=color:#f92672>&lt;-</span> importance_df_mean[15<span style=color:#f92672>:</span><span style=color:#ae81ff>18</span>]
</span></span><span style=display:flex><span>importance_df_Reliability <span style=color:#f92672>&lt;-</span> importance_df_mean[19<span style=color:#f92672>:</span><span style=color:#ae81ff>22</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>importance_df_dim <span style=color:#f92672>&lt;-</span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>c</span>(Tangibility<span style=color:#f92672>=</span><span style=color:#a6e22e>mean</span>(importance_df_Tangibility),
</span></span><span style=display:flex><span>    Assurance<span style=color:#f92672>=</span><span style=color:#a6e22e>mean</span>(importance_df_Assurance),
</span></span><span style=display:flex><span>    Empathy<span style=color:#f92672>=</span><span style=color:#a6e22e>mean</span>(importance_df_Empathy),
</span></span><span style=display:flex><span>    Responseness<span style=color:#f92672>=</span><span style=color:#a6e22e>mean</span>(importance_df_Responseness),
</span></span><span style=display:flex><span>    Reliability<span style=color:#f92672>=</span><span style=color:#a6e22e>mean</span>(importance_df_Reliability))
</span></span><span style=display:flex><span><span style=color:#75715e>#---------------------------------------------------</span>
</span></span><span style=display:flex><span>satisfaction_df_dim
</span></span><span style=display:flex><span>importance_df_dim
</span></span><span style=display:flex><span><span style=color:#75715e>#---------------------------------------------------</span>
</span></span><span style=display:flex><span>ipa_df <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>data.frame</span>(importance_df_dim,satisfaction_df_dim)
</span></span><span style=display:flex><span>ipa_df
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ipa <span style=color:#f92672>&lt;-</span> <span style=color:#66d9ef>NULL</span>
</span></span><span style=display:flex><span>ipa <span style=color:#f92672>&lt;-</span> ipa_df <span style=color:#f92672>%&gt;%</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>mutate</span>( cmove <span style=color:#f92672>=</span> importance_df_dim <span style=color:#f92672>-</span> <span style=color:#a6e22e>mean</span>(importance_df_dim) ) <span style=color:#f92672>%&gt;%</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>mutate</span>( smove <span style=color:#f92672>=</span> satisfaction_df_dim <span style=color:#f92672>-</span> <span style=color:#a6e22e>mean</span>(satisfaction_df_dim )) <span style=color:#f92672>%&gt;%</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>data.frame</span>() 
</span></span><span style=display:flex><span><span style=color:#75715e>#--------IPA1 GGplot---------------------------------------------------------</span>
</span></span><span style=display:flex><span>empty_theme <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>theme</span>(                              
</span></span><span style=display:flex><span>  plot.background <span style=color:#f92672>=</span> <span style=color:#a6e22e>element_blank</span>(), 
</span></span><span style=display:flex><span>  panel.grid.major <span style=color:#f92672>=</span> <span style=color:#a6e22e>element_blank</span>(), 
</span></span><span style=display:flex><span>  panel.grid.minor <span style=color:#f92672>=</span> <span style=color:#a6e22e>element_blank</span>(), 
</span></span><span style=display:flex><span>  panel.border <span style=color:#f92672>=</span> <span style=color:#a6e22e>element_blank</span>(), 
</span></span><span style=display:flex><span>  panel.background <span style=color:#f92672>=</span> <span style=color:#a6e22e>element_blank</span>(),
</span></span><span style=display:flex><span>  axis.line <span style=color:#f92672>=</span> <span style=color:#a6e22e>element_blank</span>(),
</span></span><span style=display:flex><span>  axis.ticks <span style=color:#f92672>=</span> <span style=color:#a6e22e>element_blank</span>(),
</span></span><span style=display:flex><span>  axis.text.y <span style=color:#f92672>=</span> <span style=color:#a6e22e>element_text</span>(angle <span style=color:#f92672>=</span> <span style=color:#ae81ff>90</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#------------------------------------------------</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#ggplot(&lt;????&gt;)+ aes(&lt;?y?й?��&gt;) #?y?й?��</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#           ?]?m?e?? </span>
</span></span><span style=display:flex><span><span style=color:#75715e>#           geom_&lt;?X???ϥ?????&gt;( # ?e?W?X???ϥ? </span>
</span></span><span style=display:flex><span><span style=color:#75715e>#  https://ggplot2-book.org/index.html     </span>
</span></span><span style=display:flex><span><span style=color:#75715e>#------------------------------------------------</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>ggplot</span>(ipa, <span style=color:#a6e22e>aes</span>(x <span style=color:#f92672>=</span> smove, y <span style=color:#f92672>=</span> cmove, label <span style=color:#f92672>=</span> <span style=color:#a6e22e>row.names</span>(ipa))) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>  empty_theme <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>theme</span>(panel.border <span style=color:#f92672>=</span> <span style=color:#a6e22e>element_rect</span>(colour <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;lightgrey&#34;</span>, fill<span style=color:#f92672>=</span><span style=color:#66d9ef>NA</span>, size<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>))<span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>labs</span>(title <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;IPA analysis&#34;</span>, y <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Counts of Dimension Sentences&#34;</span>, x <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Sentiment Score of Dimension&#34;</span>) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>geom_vline</span>(xintercept <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>, colour <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;lightgrey&#34;</span>, size<span style=color:#f92672>=</span><span style=color:#ae81ff>0.5</span>) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>geom_hline</span>(yintercept <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>, colour <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;lightgrey&#34;</span>, size<span style=color:#f92672>=</span><span style=color:#ae81ff>0.5</span>) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>geom_point</span>( size <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.5</span>)<span style=color:#f92672>+</span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>geom_label_repel</span>(size <span style=color:#f92672>=</span> <span style=color:#ae81ff>4</span>, fill <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;deepskyblue&#34;</span>, colour <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;black&#34;</span>, min.segment.length <span style=color:#f92672>=</span> <span style=color:#a6e22e>unit</span>(<span style=color:#ae81ff>0</span>, <span style=color:#e6db74>&#34;lines&#34;</span>)) 
</span></span><span style=display:flex><span><span style=color:#75715e>#plot</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#dv.off()</span>
</span></span></code></pre></div><hr><h2 id=20240229>20240229</h2><p>IPA in R (文字篇) - FTTA (From Text to Action, From Mining to Meaning)</p><p>1.下載 noteapd++ <a href=https://notepad-plus-plus.org/downloads/ target=_blank>https://notepad-plus-plus.org/downloads/</a></p><p>2.中文情緒字典 TLSSD(Tsao, Lin, and Su SD) TLSSD.csv</p><p>3.中文停止詞 stopwordsutf8.csv</p><p>4.Jeiba_Tsao_SERVQ_IPA_0200_0312.R <a href=https://www.sidrlab.net/ target=_blank>https://www.sidrlab.net/</a></p><p>5.文字集 3J.xlsx</p><p>6.構面特徵關鍵字集: 3JDim.xlsx
7.參考文獻:Tsao ,Hsiu-Yuan, Colin Campbell, Sean Sands, Alexis Mavrommatis (2022),” From mining to meaning: How B2B marketers can leverage text to inform strategy”, Industrial Marketing Management , 106, pp.90-98. (SSCI, Impact Factor = 8.89, rank in Management (Q1))</p><p>下載FTTA_R.ZIP 可得到2.到6.</p><h3 id=python程式碼-1>Python程式碼</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> jieba
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> pandas <span style=color:#66d9ef>as</span> pd
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> nltk
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> nltk.tokenize <span style=color:#f92672>import</span> sent_tokenize
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> snownlp <span style=color:#f92672>import</span> SnowNLP
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> csv
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> wordcloud <span style=color:#f92672>import</span> WordCloud
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> matplotlib.pyplot <span style=color:#66d9ef>as</span> plt
</span></span><span style=display:flex><span><span style=color:#75715e># 下載NLTK資源</span>
</span></span><span style=display:flex><span>nltk<span style=color:#f92672>.</span>download(<span style=color:#e6db74>&#39;punkt&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Function to load sentiment dictionary from file</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>load_sentiment_dictionary</span>(filename):
</span></span><span style=display:flex><span>    sentiment_dict <span style=color:#f92672>=</span> {}
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>with</span> open(filename, <span style=color:#e6db74>&#39;r&#39;</span>, newline<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;&#39;</span>, encoding<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;utf-8&#39;</span>) <span style=color:#66d9ef>as</span> csvfile:
</span></span><span style=display:flex><span>        reader <span style=color:#f92672>=</span> csv<span style=color:#f92672>.</span>reader(csvfile)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> row <span style=color:#f92672>in</span> reader:
</span></span><span style=display:flex><span>            word, score <span style=color:#f92672>=</span> row
</span></span><span style=display:flex><span>            sentiment_dict[word] <span style=color:#f92672>=</span> int(score)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> sentiment_dict
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Load sentiment dictionary from file</span>
</span></span><span style=display:flex><span>sentiment_dict <span style=color:#f92672>=</span> load_sentiment_dictionary(<span style=color:#e6db74>&#39;TLSSD.csv&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> re
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>split_chinese_sentences</span>(text):
</span></span><span style=display:flex><span>    <span style=color:#75715e># 定义中文标点符号的正则表达式模式</span>
</span></span><span style=display:flex><span>    chinese_punctuation_pattern <span style=color:#f92672>=</span> <span style=color:#e6db74>r</span><span style=color:#e6db74>&#39;[！？。；]&#39;</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># 使用正则表达式模式分割文本</span>
</span></span><span style=display:flex><span>    sentences <span style=color:#f92672>=</span> re<span style=color:#f92672>.</span>split(chinese_punctuation_pattern, text)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># 移除空字符串</span>
</span></span><span style=display:flex><span>    sentences <span style=color:#f92672>=</span> [sentence<span style=color:#f92672>.</span>strip() <span style=color:#66d9ef>for</span> sentence <span style=color:#f92672>in</span> sentences <span style=color:#66d9ef>if</span> sentence<span style=color:#f92672>.</span>strip()]
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> sentences
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 拆解中文句子</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#sentences = split_chinese_sentences(text)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 計算句子的情緒分數</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>calculate_emotion_score</span>(sentence, sentiment_dict):
</span></span><span style=display:flex><span>    words <span style=color:#f92672>=</span> jieba<span style=color:#f92672>.</span>lcut(sentence)
</span></span><span style=display:flex><span>    score <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    avg_sentence_scores <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> word <span style=color:#f92672>in</span> words:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> word <span style=color:#f92672>in</span> sentiment_dict:
</span></span><span style=display:flex><span>            score<span style=color:#f92672>.</span>append(sentiment_dict[word])
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> score:
</span></span><span style=display:flex><span>        avg_sentiment_score <span style=color:#f92672>=</span> sum(score) <span style=color:#f92672>/</span> len(score)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>        avg_sentiment_score <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    avg_sentence_scores<span style=color:#f92672>.</span>append(avg_sentiment_score)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> avg_sentence_scores
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 定義函式來處理文件</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>process_file</span>(file_path):
</span></span><span style=display:flex><span>    <span style=color:#75715e># 儲存行數、句子序號、句子和情緒分數的列表</span>
</span></span><span style=display:flex><span>    line_numbers <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    sentence_numbers <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    sentences <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    sentiment_scores <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    <span style=color:#75715e># Initialize a list to store average sentence scores</span>
</span></span><span style=display:flex><span>    emotion_scores <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 開啟文件並逐行處理</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>with</span> open(file_path, <span style=color:#e6db74>&#39;r&#39;</span>, encoding<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;utf-8&#39;</span>) <span style=color:#66d9ef>as</span> file:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> line_number, line <span style=color:#f92672>in</span> enumerate(file, start<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>):
</span></span><span style=display:flex><span>            <span style=color:#75715e># 將每一行拆解成句子</span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>#line_sentences = sent_tokenize(line.strip())</span>
</span></span><span style=display:flex><span>            line_sentences <span style=color:#f92672>=</span> split_chinese_sentences(line)
</span></span><span style=display:flex><span>            <span style=color:#75715e># 記錄每個句子的行數、句子序號、句子本身和情緒分數</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> sentence_number, sentence <span style=color:#f92672>in</span> enumerate(line_sentences, start<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>):
</span></span><span style=display:flex><span>                line_numbers<span style=color:#f92672>.</span>append(line_number)
</span></span><span style=display:flex><span>                sentence_numbers<span style=color:#f92672>.</span>append(sentence_number)
</span></span><span style=display:flex><span>                sentences<span style=color:#f92672>.</span>append(sentence)
</span></span><span style=display:flex><span>                <span style=color:#75715e># 使用SnowNLP進行情緒分析</span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>#sentiment_score = SnowNLP(sentence).sentiments</span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>#sentiment_scores.append(sentiment_score)</span>
</span></span><span style=display:flex><span>                emotion_scores<span style=color:#f92672>.</span>append(calculate_emotion_score(sentence, sentiment_dict))
</span></span><span style=display:flex><span>                <span style=color:#75715e># 將行數、句子序號、句子和情緒分數記錄成DataFrame</span>
</span></span><span style=display:flex><span>    df <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>DataFrame({<span style=color:#e6db74>&#39;Line Number&#39;</span>: line_numbers, <span style=color:#e6db74>&#39;Sentence Number&#39;</span>: sentence_numbers, <span style=color:#e6db74>&#39;Sentence&#39;</span>: sentences, <span style=color:#e6db74>&#39;Sentiment Score&#39;</span>: emotion_scores})
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> df
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 調用函式並讀取中文文字檔</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#file_path = &#39;shopify.txt&#39;  # 請將檔案路徑替換為你的文字檔路徑</span>
</span></span><span style=display:flex><span>file_path <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;3J.txt&#39;</span>  <span style=color:#75715e># 請將檔案路徑替換為你的文字檔路徑</span>
</span></span><span style=display:flex><span>text_dataframe <span style=color:#f92672>=</span> process_file(file_path)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 顯示DataFrame</span>
</span></span><span style=display:flex><span>print(text_dataframe)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#---------------------------------------------------------------------------</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 根據關鍵字判斷構面的函數</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>classify_aspect</span>(sentence, aspect_keywords):
</span></span><span style=display:flex><span>    words <span style=color:#f92672>=</span> jieba<span style=color:#f92672>.</span>lcut(sentence)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> word <span style=color:#f92672>in</span> words:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> aspect, keywords <span style=color:#f92672>in</span> aspect_keywords<span style=color:#f92672>.</span>items():
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> word <span style=color:#f92672>in</span> keywords:
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>return</span> aspect
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#39;unknown&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 從文件中讀取不同構面特徵關鍵字</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>load_aspect_keywords</span>(file_path):
</span></span><span style=display:flex><span>    aspect_keywords <span style=color:#f92672>=</span> {}
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>with</span> open(file_path, <span style=color:#e6db74>&#39;r&#39;</span>, encoding<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;utf-8&#39;</span>) <span style=color:#66d9ef>as</span> file:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> line <span style=color:#f92672>in</span> file:
</span></span><span style=display:flex><span>            aspect, <span style=color:#f92672>*</span>keywords <span style=color:#f92672>=</span> line<span style=color:#f92672>.</span>strip()<span style=color:#f92672>.</span>split()
</span></span><span style=display:flex><span>            aspect_keywords[aspect] <span style=color:#f92672>=</span> keywords
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> aspect_keywords
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 測試句子</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#test_sentences = [</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#    &#34;這家餐廳的菜好吃，服務也很好。&#34;,</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#    &#34;這本書的內容非常有趣。&#34;,</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#    &#34;這個產品的品質不怎麼樣。&#34;,</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#    &#34;今天的天氣真糟糕，讓人感到很沮喪。&#34;,</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#    &#34;這個活動很一般，沒有特別的感覺。&#34;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>test_sentences <span style=color:#f92672>=</span> text_dataframe
</span></span><span style=display:flex><span><span style=color:#75715e># 文件路徑</span>
</span></span><span style=display:flex><span>keywords_file_path <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;3JDims.txt&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 加載關鍵字</span>
</span></span><span style=display:flex><span>aspect_keywords <span style=color:#f92672>=</span> load_aspect_keywords(keywords_file_path)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>aspects <span style=color:#f92672>=</span> [] 
</span></span><span style=display:flex><span>sentences <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span><span style=color:#75715e># 進行構面分類並標註的主程式</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> sentence <span style=color:#f92672>in</span> text_dataframe[<span style=color:#e6db74>&#39;Sentence&#39;</span>]:
</span></span><span style=display:flex><span>    aspect <span style=color:#f92672>=</span> classify_aspect(sentence, aspect_keywords)
</span></span><span style=display:flex><span>    sentences<span style=color:#f92672>.</span>append(sentence)
</span></span><span style=display:flex><span>    aspects<span style=color:#f92672>.</span>append(aspect)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;句子: &#39;</span><span style=color:#e6db74>{</span>sentence<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;，構面: </span><span style=color:#e6db74>{</span>aspect<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>text_dataframe[<span style=color:#e6db74>&#39;aspect&#39;</span>] <span style=color:#f92672>=</span> aspects
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>df <span style=color:#f92672>=</span> text_dataframe
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#view data types for each column</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#df.dtypes</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>sentiment_sores <span style=color:#f92672>=</span> []    
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(len(df)):
</span></span><span style=display:flex><span>    sentiment_sores<span style=color:#f92672>.</span>append(df<span style=color:#f92672>.</span>iloc[i,<span style=color:#ae81ff>3</span>][<span style=color:#ae81ff>0</span>])
</span></span><span style=display:flex><span>df[<span style=color:#e6db74>&#39;Sentiment Score&#39;</span>] <span style=color:#f92672>=</span> sentiment_sores 
</span></span><span style=display:flex><span><span style=color:#75715e>#------------------------------------------</span>
</span></span><span style=display:flex><span>positive_df <span style=color:#f92672>=</span> df[df[<span style=color:#e6db74>&#39;Sentiment Score&#39;</span>] <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>negative_df <span style=color:#f92672>=</span> df[df[<span style=color:#e6db74>&#39;Sentiment Score&#39;</span>] <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span><span style=color:#75715e>#------------------------------------------</span>
</span></span><span style=display:flex><span>text<span style=color:#f92672>=</span>positive_df[<span style=color:#e6db74>&#39;Sentence&#39;</span>]<span style=color:#f92672>.</span>values<span style=color:#f92672>.</span>tolist()
</span></span><span style=display:flex><span>    <span style=color:#75715e># 使用jieba進行分詞</span>
</span></span><span style=display:flex><span>text <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39; &#39;</span><span style=color:#f92672>.</span>join(text)
</span></span><span style=display:flex><span>wordlist <span style=color:#f92672>=</span> jieba<span style=color:#f92672>.</span>cut(text, cut_all<span style=color:#f92672>=</span><span style=color:#66d9ef>False</span>)
</span></span><span style=display:flex><span>positive_process_text <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39; &#39;</span><span style=color:#f92672>.</span>join(wordlist)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>text<span style=color:#f92672>=</span>negative_df[<span style=color:#e6db74>&#39;Sentence&#39;</span>]<span style=color:#f92672>.</span>values<span style=color:#f92672>.</span>tolist()
</span></span><span style=display:flex><span>    <span style=color:#75715e># 使用jieba進行分詞</span>
</span></span><span style=display:flex><span>text <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39; &#39;</span><span style=color:#f92672>.</span>join(text)
</span></span><span style=display:flex><span>wordlist <span style=color:#f92672>=</span> jieba<span style=color:#f92672>.</span>cut(text, cut_all<span style=color:#f92672>=</span><span style=color:#66d9ef>False</span>)
</span></span><span style=display:flex><span>negative_process_text <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39; &#39;</span><span style=color:#f92672>.</span>join(wordlist)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 加载停用词列表</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#-------------------------------------------------------</span>
</span></span><span style=display:flex><span><span style=color:#75715e># WordCloud</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#-------------------------------------------------------</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 文本预处理函数，去除停用词</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>generate_wordcloud</span>(text):
</span></span><span style=display:flex><span><span style=color:#75715e># 去除停用词后的文本</span>
</span></span><span style=display:flex><span>    stopwords <span style=color:#f92672>=</span> set()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#39;stopwordsutf8.txt&#39;</span>, <span style=color:#e6db74>&#39;r&#39;</span>, encoding<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;utf-8&#39;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> line <span style=color:#f92672>in</span> f:
</span></span><span style=display:flex><span>            stopwords<span style=color:#f92672>.</span>add(line<span style=color:#f92672>.</span>strip())
</span></span><span style=display:flex><span>    words <span style=color:#f92672>=</span> jieba<span style=color:#f92672>.</span>cut(text)
</span></span><span style=display:flex><span>    filtered_words <span style=color:#f92672>=</span> [word <span style=color:#66d9ef>for</span> word <span style=color:#f92672>in</span> words <span style=color:#66d9ef>if</span> word <span style=color:#f92672>not</span> <span style=color:#f92672>in</span> stopwords]
</span></span><span style=display:flex><span>    processed_text <span style=color:#f92672>=</span>  <span style=color:#e6db74>&#39; &#39;</span><span style=color:#f92672>.</span>join(filtered_words)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#wget https://raw.githubusercontent.com/victorgau/wordcloud/master/SourceHanSansTW-Regular.otf</span>
</span></span><span style=display:flex><span>    font_path<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;SourceHanSansTW-Regular.otf&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 創建文字雲</span>
</span></span><span style=display:flex><span>    wordcloud <span style=color:#f92672>=</span> WordCloud(font_path<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;SourceHanSansTW-Regular.otf&#39;</span>,  background_coloR<span style=color:#e6db74>&#39;white&#39;</span>)<span style=color:#f92672>.</span>generate(processed_text)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 使用matplotlib展示文字雲</span>
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>imshow(wordcloud, interpolation<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;bilinear&#39;</span>)
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>axis(<span style=color:#e6db74>&#34;off&#34;</span>)
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>show()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>pass</span> 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 去除停用词后的文本</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#positive_processed_text = remove_stopwords(positive_wordlist_space_split)</span>
</span></span><span style=display:flex><span>generate_wordcloud(positive_process_text)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#negative_processed_text = remove_stopwords(negative_wordlist_space_split)</span>
</span></span><span style=display:flex><span>generate_wordcloud(negative_process_text)
</span></span><span style=display:flex><span><span style=color:#75715e>#-------------------------------------------------------</span>
</span></span><span style=display:flex><span><span style=color:#75715e># IPA Matrix</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#-------------------------------------------------------</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>calculate_value_counts_and_mean</span>(data_frame, count_column, value_column):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    计算DataFrame中某个列的值出现的次数以及相应的另一个列的平均值，并将结果转换为DataFrame
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    :param data_frame: DataFrame对象
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    :param count_column: 用于计算值出现次数的列名
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    :param value_column: 用于计算平均值的列名
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    :return: 返回一个DataFrame，包含计数、平均值和Attribute列，索引为不同的值
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>    result <span style=color:#f92672>=</span> {}
</span></span><span style=display:flex><span>    grouped <span style=color:#f92672>=</span> data_frame<span style=color:#f92672>.</span>groupby(count_column)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> name, group <span style=color:#f92672>in</span> grouped:
</span></span><span style=display:flex><span>        value_counts <span style=color:#f92672>=</span> group[value_column]<span style=color:#f92672>.</span>count()
</span></span><span style=display:flex><span>        mean_value <span style=color:#f92672>=</span> group[value_column]<span style=color:#f92672>.</span>mean()
</span></span><span style=display:flex><span>        result[name] <span style=color:#f92672>=</span> (value_counts, mean_value)
</span></span><span style=display:flex><span>    result_df <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>DataFrame<span style=color:#f92672>.</span>from_dict(result, orient<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;index&#39;</span>, columns<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#39;Importance&#39;</span>, <span style=color:#e6db74>&#39;Sentiment&#39;</span>])<span style=color:#f92672>.</span>reset_index()
</span></span><span style=display:flex><span>    result_df<span style=color:#f92672>.</span>rename(columns<span style=color:#f92672>=</span>{<span style=color:#e6db74>&#39;index&#39;</span>: <span style=color:#e6db74>&#39;Attribute&#39;</span>}, inplace<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> result_df
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 要计算的列名</span>
</span></span><span style=display:flex><span>count_column <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;aspect&#39;</span>
</span></span><span style=display:flex><span>value_column <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;Sentiment Score&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 调用函数计算列值出现次数和对应的平均值，并转换为DataFrame</span>
</span></span><span style=display:flex><span>result_df <span style=color:#f92672>=</span> calculate_value_counts_and_mean(df, count_column, value_column)
</span></span><span style=display:flex><span>print(result_df)
</span></span><span style=display:flex><span><span style=color:#75715e>#-------------------------------------------------------</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Plot IPA Matrix</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#-------------------------------------------------------</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Plot</span>
</span></span><span style=display:flex><span>df <span style=color:#f92672>=</span> result_df[result_df[<span style=color:#e6db74>&#39;Attribute&#39;</span>] <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#39;unknown&#39;</span>]
</span></span><span style=display:flex><span>fig, ax <span style=color:#f92672>=</span> plt<span style=color:#f92672>.</span>subplots()
</span></span><span style=display:flex><span><span style=color:#75715e>#df.plot(kind=&#39;scatter&#39;, x=&#39;Importance&#39;, y=&#39;Performance&#39;, ax=ax)</span>
</span></span><span style=display:flex><span>df<span style=color:#f92672>.</span>plot(kind<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;scatter&#39;</span>, x<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Sentiment&#39;</span>, y<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Importance&#39;</span>, ax<span style=color:#f92672>=</span>ax)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Label points in the scatter plot</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i, txt <span style=color:#f92672>in</span> enumerate(df<span style=color:#f92672>.</span>Attribute):
</span></span><span style=display:flex><span>    ax<span style=color:#f92672>.</span>annotate(txt, (df<span style=color:#f92672>.</span>Sentiment[i],df<span style=color:#f92672>.</span>Importance[i] ))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Set chart title and labels</span>
</span></span><span style=display:flex><span>ax<span style=color:#f92672>.</span>set_title(<span style=color:#e6db74>&#39;FTTA Analysis&#39;</span>)
</span></span><span style=display:flex><span>ax<span style=color:#f92672>.</span>set_xlabel(<span style=color:#e6db74>&#39;Sentiment&#39;</span>)
</span></span><span style=display:flex><span>ax<span style=color:#f92672>.</span>set_ylabel(<span style=color:#e6db74>&#39;Importance&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Draw mean lines for importance and performance</span>
</span></span><span style=display:flex><span>mean_importance <span style=color:#f92672>=</span> df[<span style=color:#e6db74>&#39;Importance&#39;</span>]<span style=color:#f92672>.</span>mean()
</span></span><span style=display:flex><span>mean_performance <span style=color:#f92672>=</span> df[<span style=color:#e6db74>&#39;Sentiment&#39;</span>]<span style=color:#f92672>.</span>mean()
</span></span><span style=display:flex><span>ax<span style=color:#f92672>.</span>axvline(x<span style=color:#f92672>=</span>mean_performance, coloR<span style=color:#e6db74>&#39;r&#39;</span>, linestyle<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;--&#39;</span>)
</span></span><span style=display:flex><span>ax<span style=color:#f92672>.</span>axhline(y<span style=color:#f92672>=</span>mean_importance, coloR<span style=color:#e6db74>&#39;r&#39;</span>, linestyle<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;--&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Show plot</span>
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>show()
</span></span></code></pre></div><h3 id=r語言程式碼-1>R語言程式碼</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-R data-lang=R><span style=display:flex><span><span style=color:#a6e22e>Sys.setlocale</span>(category <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;LC_ALL&#34;</span>, locale <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;C.UTF-8&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(data.table)
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(jiebaR)
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(wordcloud)
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(stringr)
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(tm)
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(dplyr)
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(tidyverse)
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(tidytext)
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(purrr)
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(reshape2)
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(wordcloud)
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(RColorBrewer)
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(tmcn)
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(wordcloud2)
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(webshot)
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(htmlwidgets)
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(igraph)
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(ggraph)
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(widyr)
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(ggplot2)
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(ggrepel)
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(xlsx)
</span></span><span style=display:flex><span><span style=color:#75715e>#--------------- test code -------------</span>
</span></span><span style=display:flex><span>filename <span style=color:#f92672>&lt;-</span> <span style=color:#e6db74>&#39;3J.xlsx&#39;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#--------------- test code -------------</span>
</span></span><span style=display:flex><span>TripText <span style=color:#f92672>=</span> <span style=color:#66d9ef>NULL</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#tenlong &lt;- fread(file=filename,sep = &#34;,&#34; ,encoding=&#34;UTF-8&#34;,headeRFALSE, stringsAsFactors=FALSE)</span>
</span></span><span style=display:flex><span>tenlong <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>read.xlsx</span>(filename, sheetIndex <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span><span style=color:#a6e22e>colnames</span>(tenlong) <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>c</span>(<span style=color:#e6db74>&#34;text&#34;</span>)
</span></span><span style=display:flex><span>tenlong <span style=color:#f92672>&lt;-</span> tenlong <span style=color:#f92672>%&gt;%</span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>mutate</span>(tenlong,line<span style=color:#f92672>=</span><span style=color:#a6e22e>c</span>(<span style=color:#ae81ff>1</span><span style=color:#f92672>:</span><span style=color:#a6e22e>nrow</span>(tenlong))) <span style=color:#f92672>%&gt;%</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>relocate</span>(line)
</span></span><span style=display:flex><span>tenlong <span style=color:#f92672>&lt;-</span> tenlong<span style=color:#a6e22e>[which</span>(<span style=color:#a6e22e>nchar</span>(tenlong<span style=color:#f92672>$</span>text) <span style=color:#f92672>&gt;</span><span style=color:#ae81ff>2</span>),]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>colnames</span>(tenlong) <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>c</span>(<span style=color:#e6db74>&#34;line&#34;</span>,<span style=color:#e6db74>&#34;text&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#75715e>#=============================================================================</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#                           斷句  (稍後解釋)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#=============================================================================</span>
</span></span><span style=display:flex><span>AZDF <span style=color:#f92672>&lt;-</span> tenlong
</span></span><span style=display:flex><span>test_text <span style=color:#f92672>&lt;-</span> <span style=color:#66d9ef>NULL</span>
</span></span><span style=display:flex><span>test_text <span style=color:#f92672>&lt;-</span> AZDF
</span></span><span style=display:flex><span>test_text<span style=color:#f92672>$</span>text <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>gsub</span>(pattern <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;。&#39;</span>,replacement <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;.&#39;</span>,test_text<span style=color:#f92672>$</span>text)
</span></span><span style=display:flex><span>test_text<span style=color:#f92672>$</span>text <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>gsub</span>(pattern <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;，&#39;</span>,replacement <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;,&#39;</span>,test_text<span style=color:#f92672>$</span>text)
</span></span><span style=display:flex><span>test_text<span style=color:#f92672>$</span>text <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>gsub</span>(pattern <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;！&#39;</span>,replacement <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;.&#39;</span>,test_text<span style=color:#f92672>$</span>text)
</span></span><span style=display:flex><span>test_text<span style=color:#f92672>$</span>text <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>gsub</span>(pattern <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;；&#39;</span>,replacement <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;.&#39;</span>,test_text<span style=color:#f92672>$</span>text)
</span></span><span style=display:flex><span>test_text<span style=color:#f92672>$</span>text <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>gsub</span>(pattern <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;？&#39;</span>,replacement <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;.&#39;</span>,test_text<span style=color:#f92672>$</span>text)
</span></span><span style=display:flex><span>test_text<span style=color:#f92672>$</span>text
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>split_into_sentences <span style=color:#f92672>&lt;-</span> <span style=color:#66d9ef>function</span>(text){
</span></span><span style=display:flex><span>  <span style=color:#75715e>#This is a function built off this Python solution that allows some flexibility in that the lists of prefixes, suffixes, etc. can be modified to your specific text. It&#39;s definitely not perfect, but could be useful with the right text.</span>
</span></span><span style=display:flex><span>  caps <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;([A-Z])&#34;</span>
</span></span><span style=display:flex><span>  prefixes <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;(Mr|St|Mrs|Ms|Dr|Prof|Capt|Cpt|Lt|Mt)\\.&#34;</span>
</span></span><span style=display:flex><span>  suffixes <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;(Inc|Ltd|Jr|Sr|Co)&#34;</span>
</span></span><span style=display:flex><span>  acronyms <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;([A-Z][.][A-Z][.](?:[A-Z][.])?)&#34;</span>
</span></span><span style=display:flex><span>  starters <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;(Mr|Mrs|Ms|Dr|He\\s|She\\s|It\\s|They\\s|Their\\s|Our\\s|We\\s|But\\s|However\\s|That\\s|This\\s|Wherever)&#34;</span>
</span></span><span style=display:flex><span>  websites <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;\\.(com|edu|gov|io|me|net|org)&#34;</span>
</span></span><span style=display:flex><span>  digits <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;([0-9])&#34;</span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  text <span style=color:#f92672>=</span> <span style=color:#a6e22e>gsub</span>(<span style=color:#e6db74>&#34;\n|\r\n&#34;</span>,<span style=color:#e6db74>&#34; &#34;</span>, text)
</span></span><span style=display:flex><span>  text <span style=color:#f92672>=</span> <span style=color:#a6e22e>gsub</span>(prefixes, <span style=color:#e6db74>&#34;\\1&lt;prd&gt;&#34;</span>, text)
</span></span><span style=display:flex><span>  text <span style=color:#f92672>=</span> <span style=color:#a6e22e>gsub</span>(websites, <span style=color:#e6db74>&#34;&lt;prd&gt;\\1&#34;</span>, text)
</span></span><span style=display:flex><span>  text <span style=color:#f92672>=</span> <span style=color:#a6e22e>gsub</span>(<span style=color:#e6db74>&#39;www\\.&#39;</span>, <span style=color:#e6db74>&#34;www&lt;prd&gt;&#34;</span>, text)
</span></span><span style=display:flex><span>  text <span style=color:#f92672>=</span> <span style=color:#a6e22e>gsub</span>(<span style=color:#e6db74>&#34;Ph.D.&#34;</span>,<span style=color:#e6db74>&#34;Ph&lt;prd&gt;D&lt;prd&gt;&#34;</span>, text)
</span></span><span style=display:flex><span>  text <span style=color:#f92672>=</span> <span style=color:#a6e22e>gsub</span>(<span style=color:#a6e22e>paste0</span>(<span style=color:#e6db74>&#34;\\s&#34;</span>, caps, <span style=color:#e6db74>&#34;\\. &#34;</span>), <span style=color:#e6db74>&#34; \\1&lt;prd&gt; &#34;</span>, text)
</span></span><span style=display:flex><span>  text <span style=color:#f92672>=</span> <span style=color:#a6e22e>gsub</span>(<span style=color:#a6e22e>paste0</span>(acronyms, <span style=color:#e6db74>&#34; &#34;</span>, starters), <span style=color:#e6db74>&#34;\\1&lt;stop&gt; \\2&#34;</span>, text)
</span></span><span style=display:flex><span>  text <span style=color:#f92672>=</span> <span style=color:#a6e22e>gsub</span>(<span style=color:#a6e22e>paste0</span>(caps, <span style=color:#e6db74>&#34;\\.&#34;</span>, caps, <span style=color:#e6db74>&#34;\\.&#34;</span>, caps, <span style=color:#e6db74>&#34;\\.&#34;</span>), <span style=color:#e6db74>&#34;\\1&lt;prd&gt;\\2&lt;prd&gt;\\3&lt;prd&gt;&#34;</span>, text)
</span></span><span style=display:flex><span>  text <span style=color:#f92672>=</span> <span style=color:#a6e22e>gsub</span>(<span style=color:#a6e22e>paste0</span>(caps, <span style=color:#e6db74>&#34;\\.&#34;</span>, caps, <span style=color:#e6db74>&#34;\\.&#34;</span>), <span style=color:#e6db74>&#34;\\1&lt;prd&gt;\\2&lt;prd&gt;&#34;</span>, text)
</span></span><span style=display:flex><span>  text <span style=color:#f92672>=</span> <span style=color:#a6e22e>gsub</span>(<span style=color:#a6e22e>paste0</span>(<span style=color:#e6db74>&#34; &#34;</span>, suffixes, <span style=color:#e6db74>&#34;\\. &#34;</span>, starters), <span style=color:#e6db74>&#34; \\1&lt;stop&gt; \\2&#34;</span>, text)
</span></span><span style=display:flex><span>  text <span style=color:#f92672>=</span> <span style=color:#a6e22e>gsub</span>(<span style=color:#a6e22e>paste0</span>(<span style=color:#e6db74>&#34; &#34;</span>, suffixes, <span style=color:#e6db74>&#34;\\.&#34;</span>), <span style=color:#e6db74>&#34; \\1&lt;prd&gt;&#34;</span>, text)
</span></span><span style=display:flex><span>  text <span style=color:#f92672>=</span> <span style=color:#a6e22e>gsub</span>(<span style=color:#a6e22e>paste0</span>(<span style=color:#e6db74>&#34; &#34;</span>, caps, <span style=color:#e6db74>&#34;\\.&#34;</span>), <span style=color:#e6db74>&#34; \\1&lt;prd&gt;&#34;</span>,text)
</span></span><span style=display:flex><span>  text <span style=color:#f92672>=</span> <span style=color:#a6e22e>gsub</span>(<span style=color:#a6e22e>paste0</span>(digits, <span style=color:#e6db74>&#34;\\.&#34;</span>, digits), <span style=color:#e6db74>&#34;\\1&lt;prd&gt;\\2&#34;</span>, text)
</span></span><span style=display:flex><span>  text <span style=color:#f92672>=</span> <span style=color:#a6e22e>gsub</span>(<span style=color:#e6db74>&#34;...&#34;</span>, <span style=color:#e6db74>&#34;&lt;prd&gt;&lt;prd&gt;&lt;prd&gt;&#34;</span>, text, fixed <span style=color:#f92672>=</span> <span style=color:#66d9ef>TRUE</span>)
</span></span><span style=display:flex><span>  text <span style=color:#f92672>=</span> <span style=color:#a6e22e>gsub</span>(<span style=color:#e6db74>&#39;\\.”&#39;</span>, <span style=color:#e6db74>&#39;”.&#39;</span>, text)
</span></span><span style=display:flex><span>  text <span style=color:#f92672>=</span> <span style=color:#a6e22e>gsub</span>(<span style=color:#e6db74>&#39;\\.&#34;&#39;</span>, <span style=color:#e6db74>&#39;\&#34;.&#39;</span>, text)
</span></span><span style=display:flex><span>  text <span style=color:#f92672>=</span> <span style=color:#a6e22e>gsub</span>(<span style=color:#e6db74>&#39;\\!&#34;&#39;</span>, <span style=color:#e6db74>&#39;&#34;!&#39;</span>, text)
</span></span><span style=display:flex><span>  text <span style=color:#f92672>=</span> <span style=color:#a6e22e>gsub</span>(<span style=color:#e6db74>&#39;\\?&#34;&#39;</span>, <span style=color:#e6db74>&#39;&#34;?&#39;</span>, text)
</span></span><span style=display:flex><span>  text <span style=color:#f92672>=</span> <span style=color:#a6e22e>gsub</span>(<span style=color:#e6db74>&#39;\\.&#39;</span>, <span style=color:#e6db74>&#39;.&lt;stop&gt;&#39;</span>, text)
</span></span><span style=display:flex><span>  text <span style=color:#f92672>=</span> <span style=color:#a6e22e>gsub</span>(<span style=color:#e6db74>&#39;\\?&#39;</span>, <span style=color:#e6db74>&#39;?&lt;stop&gt;&#39;</span>, text)
</span></span><span style=display:flex><span>  text <span style=color:#f92672>=</span> <span style=color:#a6e22e>gsub</span>(<span style=color:#e6db74>&#39;\\!&#39;</span>, <span style=color:#e6db74>&#39;!&lt;stop&gt;&#39;</span>, text)
</span></span><span style=display:flex><span>  text <span style=color:#f92672>=</span> <span style=color:#a6e22e>gsub</span>(<span style=color:#e6db74>&#39;&lt;prd&gt;&#39;</span>, <span style=color:#e6db74>&#39;.&#39;</span>, text)
</span></span><span style=display:flex><span>  sentence <span style=color:#f92672>=</span> <span style=color:#a6e22e>strsplit</span>(text, <span style=color:#e6db74>&#34;&lt;stop&gt;\\s*&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span>(sentence)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>df_sentences  <span style=color:#f92672>&lt;-</span> <span style=color:#66d9ef>NULL</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> (i <span style=color:#66d9ef>in</span> <span style=color:#ae81ff>1</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>nrow</span>(AZDF)) {
</span></span><span style=display:flex><span>  df_sentences_t <span style=color:#f92672>&lt;-</span> <span style=color:#66d9ef>NULL</span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  sentences <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>split_into_sentences</span>(test_text<span style=color:#f92672>$</span>text[i])
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>names</span>(sentences) <span style=color:#f92672>&lt;-</span> <span style=color:#e6db74>&#39;sentence&#39;</span>
</span></span><span style=display:flex><span>  df_sentences_t <span style=color:#f92672>&lt;-</span> dplyr<span style=color:#f92672>::</span><span style=color:#a6e22e>bind_rows</span>(sentences) 
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#75715e>#chapterno &lt;- rep(test_text$chapter[i],times=nrow(df_sentences_t))</span>
</span></span><span style=display:flex><span>  lineno <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>rep</span>(test_text<span style=color:#f92672>$</span>line[i],times<span style=color:#f92672>=</span><span style=color:#a6e22e>nrow</span>(df_sentences_t))
</span></span><span style=display:flex><span>  <span style=color:#75715e>#dateno &lt;- rep(test_text$t1date[i],times=nrow(df_sentences_t))</span>
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  sentenceno <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>c</span>(<span style=color:#ae81ff>1</span><span style=color:#f92672>:</span><span style=color:#a6e22e>nrow</span>(df_sentences_t))
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  df_sentences_t <span style=color:#f92672>&lt;-</span> dplyr<span style=color:#f92672>::</span><span style=color:#a6e22e>bind_cols</span>(lineno, sentenceno,df_sentences_t)
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>colnames</span>(df_sentences_t) <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>c</span>(<span style=color:#e6db74>&#34;line&#34;</span>,<span style=color:#e6db74>&#34;sentenceno&#34;</span>,<span style=color:#e6db74>&#34;text&#34;</span>)
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  df_sentences <span style=color:#f92672>&lt;-</span> dplyr<span style=color:#f92672>::</span><span style=color:#a6e22e>bind_rows</span>(df_sentences,df_sentences_t)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>AZDF01 <span style=color:#f92672>&lt;-</span> df_sentences
</span></span><span style=display:flex><span>AZDF01<span style=color:#f92672>$</span>text<span style=color:#f92672>=</span><span style=color:#a6e22e>gsub</span>(<span style=color:#e6db74>&#34;\\.&#34;</span>,<span style=color:#e6db74>&#34;&#34;</span>,AZDF01<span style=color:#f92672>$</span>text)
</span></span><span style=display:flex><span>AZDF02 <span style=color:#f92672>&lt;-</span> AZDF01<span style=color:#a6e22e>[which</span>(<span style=color:#a6e22e>nchar</span>(AZDF01<span style=color:#f92672>$</span>text) <span style=color:#f92672>&gt;</span><span style=color:#ae81ff>1</span>),]
</span></span><span style=display:flex><span>TripText <span style=color:#f92672>&lt;-</span> AZDF02[,<span style=color:#ae81ff>-2</span>]
</span></span><span style=display:flex><span>TripText01 <span style=color:#f92672>&lt;-</span> TripText<span style=color:#f92672>$</span>line
</span></span><span style=display:flex><span>TripText02 <span style=color:#f92672>&lt;-</span> TripText<span style=color:#f92672>$</span>text
</span></span><span style=display:flex><span><span style=color:#75715e>#=============================================================================</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#   中文情緒字典 TLSSD(Tsao &amp; Lin &amp; Su) 情緒字典</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#=============================================================================</span>
</span></span><span style=display:flex><span>afinn_list <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>fread</span>(file<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;TLSSD.csv&#39;</span>,encoding<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;UTF-8&#34;</span>,headeRFALSE, stringsAsFactors<span style=color:#f92672>=</span><span style=color:#66d9ef>FALSE</span>)
</span></span><span style=display:flex><span><span style=color:#a6e22e>names</span>(afinn_list) <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>c</span>(<span style=color:#e6db74>&#39;word&#39;</span>, <span style=color:#e6db74>&#39;score&#39;</span>)
</span></span><span style=display:flex><span>afinn_list<span style=color:#f92672>$</span>word <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>tolower</span>(afinn_list<span style=color:#f92672>$</span>word)
</span></span><span style=display:flex><span><span style=color:#75715e>#------------- get_noun ----------------------</span>
</span></span><span style=display:flex><span>get_noun <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span>(x){
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>stopifnot</span>(<span style=color:#a6e22e>inherits</span>(x,<span style=color:#e6db74>&#34;character&#34;</span>))
</span></span><span style=display:flex><span>  index <span style=color:#f92672>=</span> <span style=color:#a6e22e>names</span>(x) <span style=color:#f92672>%in%</span> <span style=color:#a6e22e>c</span>(<span style=color:#e6db74>&#34;n&#34;</span>,<span style=color:#e6db74>&#34;nr&#34;</span>,<span style=color:#e6db74>&#34;nr1&#34;</span>,<span style=color:#e6db74>&#34;nr2&#34;</span>,<span style=color:#e6db74>&#34;nrj&#34;</span>,<span style=color:#e6db74>&#34;nrf&#34;</span>,<span style=color:#e6db74>&#34;ns&#34;</span>,<span style=color:#e6db74>&#34;nsf&#34;</span>,<span style=color:#e6db74>&#34;nt&#34;</span>,<span style=color:#e6db74>&#34;nz&#34;</span>,
</span></span><span style=display:flex><span>                          <span style=color:#e6db74>&#34;nl&#34;</span>,<span style=color:#e6db74>&#34;ng&#34;</span>,
</span></span><span style=display:flex><span>                          <span style=color:#e6db74>&#34;a&#34;</span>,<span style=color:#e6db74>&#34;ad&#34;</span>,<span style=color:#e6db74>&#34;an&#34;</span>,<span style=color:#e6db74>&#34;ag&#34;</span>,<span style=color:#e6db74>&#34;al&#34;</span>,
</span></span><span style=display:flex><span>                          <span style=color:#e6db74>&#34;v&#34;</span>,<span style=color:#e6db74>&#34;vh&#34;</span>,<span style=color:#e6db74>&#34;vg&#34;</span>,<span style=color:#e6db74>&#34;vd&#34;</span>,<span style=color:#e6db74>&#34;vn&#34;</span>,<span style=color:#e6db74>&#34;vi*&#34;</span>,<span style=color:#e6db74>&#34;vq*&#34;</span>,
</span></span><span style=display:flex><span>                          <span style=color:#e6db74>&#34;d&#34;</span>,<span style=color:#e6db74>&#34;x&#34;</span>,<span style=color:#e6db74>&#34;b&#34;</span>)
</span></span><span style=display:flex><span>  x[index]
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#75715e>#---------------tokenizer--------------------</span>
</span></span><span style=display:flex><span>chi_tokenizerN <span style=color:#f92672>&lt;-</span> <span style=color:#66d9ef>function</span> (t) {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>lapply</span>(t, <span style=color:#66d9ef>function</span>(x){
</span></span><span style=display:flex><span>    tokens <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>segment</span>(x, jieba_tokenizerN)
</span></span><span style=display:flex><span>    tokens <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>get_noun</span>(tokens<span style=color:#a6e22e>[nchar</span>(tokens) <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>1</span>])
</span></span><span style=display:flex><span>    <span style=color:#75715e>#tokens &lt;- tokens[nchar(tokens) &gt; 1]</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span>(tokens)
</span></span><span style=display:flex><span>  })
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#---------------user define stop words ------</span>
</span></span><span style=display:flex><span>swords <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>fread</span>(file<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;stopwordsutf8.csv&#39;</span>,encoding<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;UTF-8&#34;</span>,headeRFALSE, stringsAsFactors<span style=color:#f92672>=</span><span style=color:#66d9ef>FALSE</span>)
</span></span><span style=display:flex><span>stopwords <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>data_frame</span>(word<span style=color:#f92672>=</span>swords<span style=color:#f92672>$</span>V1)
</span></span><span style=display:flex><span><span style=color:#75715e># --------------------Jieba TAG and User Define Dict -----</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#jieba_tokenizer = worker(type=&#34;tag&#34;, user = &#34;three_kingdoms_lexicon.traditional.dict&#34;)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#jieba_tokenizer = worker(user = &#34;three_kingdoms_lexicon.traditional.dict&#34;)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#jieba_tokenizer = worker(&#34;tag&#34;,write = &#34;NOFILE&#34;)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#jieba_tokenizer = worker(write = &#34;NOFILE&#34;,user = &#34;tenlong8_user_dict.utf8&#34;)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#jieba_tokenizer = worker()</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#------------------------------------------------------------</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#jieba_tokenizer = worker(&#34;tag&#34;,write = &#34;NOFILE&#34;)</span>
</span></span><span style=display:flex><span>jieba_tokenizerN <span style=color:#f92672>=</span> <span style=color:#a6e22e>worker</span>(type<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;tag&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#75715e>#----------------   unnest -------------------------------</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>new_user_word</span>(jieba_tokenizerN, 
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>c</span>(<span style=color:#e6db74>&#34;蔡英文&#34;</span>, <span style=color:#e6db74>&#34;韓國瑜&#34;</span>,<span style=color:#e6db74>&#34;國安五法&#34;</span>,<span style=color:#e6db74>&#34;中共代理人法&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;李登輝&#34;</span>,<span style=color:#e6db74>&#34;馬英九&#34;</span>,<span style=color:#e6db74>&#34;蔣經國&#34;</span>,<span style=color:#e6db74>&#34;陳水扁&#34;</span>,<span style=color:#e6db74>&#34;柯文哲&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;王美花&#34;</span>,<span style=color:#e6db74>&#34;雞排&#34;</span>,<span style=color:#e6db74>&#34;郭董&#34;</span>,<span style=color:#e6db74>&#34;郭台銘&#34;</span>,<span style=color:#e6db74>&#34;缺電&#34;</span>,<span style=color:#e6db74>&#34;設備&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#e6db74>&#34;台電&#34;</span>,<span style=color:#e6db74>&#34;限電&#34;</span>,<span style=color:#e6db74>&#34;電力&#34;</span>,<span style=color:#e6db74>&#34;三接&#34;</span>,<span style=color:#e6db74>&#34;下台&#34;</span>
</span></span><span style=display:flex><span>              ))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>tokens <span style=color:#f92672>&lt;-</span> AZDF02 <span style=color:#f92672>%&gt;%</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>unnest_tokens</span>(word, text, token <span style=color:#f92672>=</span> chi_tokenizerN) <span style=color:#f92672>%&gt;%</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>anti_join</span>(stopwords)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>text_line       <span style=color:#f92672>&lt;-</span> tokens<span style=color:#f92672>$</span>line
</span></span><span style=display:flex><span>text_sentenceno <span style=color:#f92672>&lt;-</span> tokens<span style=color:#f92672>$</span>sentenceno
</span></span><span style=display:flex><span>text_word       <span style=color:#f92672>&lt;-</span> tokens<span style=color:#f92672>$</span>word
</span></span><span style=display:flex><span>text_dataset <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>data_frame</span>(line<span style=color:#f92672>=</span>text_line,sentenceno<span style=color:#f92672>=</span>tokens<span style=color:#f92672>$</span>sentenceno,word<span style=color:#f92672>=</span>text_word )
</span></span><span style=display:flex><span><span style=color:#75715e>#------------------ sentiment Analysis -------------------------------</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#------------------calaulate score of sentiment ---------------------</span>
</span></span><span style=display:flex><span>afinn_score_df <span style=color:#f92672>&lt;-</span> text_dataset <span style=color:#f92672>%&gt;%</span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>inner_join</span>(afinn_list,by<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;word&#34;</span>) <span style=color:#f92672>%&gt;%</span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>group_by</span>(line)  <span style=color:#f92672>%&gt;%</span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>arrange</span>(line)
</span></span><span style=display:flex><span>afinn_score_df 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>sentiment_score_df_sentence <span style=color:#f92672>&lt;-</span> afinn_score_df <span style=color:#f92672>%&gt;%</span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>group_by</span>(line,sentenceno) <span style=color:#f92672>%&gt;%</span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>arrange</span>(line) <span style=color:#f92672>%&gt;%</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>summarise</span>(sentiment<span style=color:#f92672>=</span><span style=color:#a6e22e>sum</span>(<span style=color:#a6e22e>as.numeric</span>(score)) )
</span></span><span style=display:flex><span>sentiment_score_df_sentence
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>sentiment_score_df_sentence <span style=color:#f92672>%&gt;%</span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>summarise</span>(sscore <span style=color:#f92672>=</span><span style=color:#a6e22e>mean</span>(sentiment))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>sentiment_score_df_sentence <span style=color:#f92672>%&gt;%</span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>ungroup</span>() <span style=color:#f92672>%&gt;%</span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>summarise</span>(sscore <span style=color:#f92672>=</span><span style=color:#a6e22e>mean</span>(sentiment))
</span></span><span style=display:flex><span><span style=color:#75715e>#------------------ Aspect / Dimensional ?i??-------------------------</span>
</span></span><span style=display:flex><span>positive_lines_df <span style=color:#f92672>&lt;-</span> sentiment_score_df_sentence <span style=color:#f92672>%&gt;%</span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>filter</span>(sentiment <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span> ) <span style=color:#f92672>%&gt;%</span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>left_join</span>(text_dataset, by<span style=color:#f92672>=</span><span style=color:#a6e22e>c</span>(<span style=color:#e6db74>&#34;line&#34;</span>,<span style=color:#e6db74>&#34;sentenceno&#34;</span>))
</span></span><span style=display:flex><span>positive_lines_df
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>negative_lines_df <span style=color:#f92672>&lt;-</span> sentiment_score_df_sentence <span style=color:#f92672>%&gt;%</span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>filter</span>(sentiment <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0</span>) <span style=color:#f92672>%&gt;%</span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>left_join</span>(text_dataset,by<span style=color:#f92672>=</span><span style=color:#a6e22e>c</span>(<span style=color:#e6db74>&#34;line&#34;</span>,<span style=color:#e6db74>&#34;sentenceno&#34;</span>))
</span></span><span style=display:flex><span>negative_lines_df
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>sentiment_words_df <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>rbind</span>(positive_lines_df,negative_lines_df)
</span></span><span style=display:flex><span>sentiment_words_df
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#------------------ restore sentences with score of sentiment ------</span>
</span></span><span style=display:flex><span>positive_lines_df_sentences <span style=color:#f92672>&lt;-</span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>unique</span>(positive_lines_df[,<span style=color:#ae81ff>1</span><span style=color:#f92672>:</span><span style=color:#ae81ff>3</span>]) <span style=color:#f92672>%&gt;%</span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>left_join</span>(AZDF02,by<span style=color:#f92672>=</span><span style=color:#a6e22e>c</span>(<span style=color:#e6db74>&#34;line&#34;</span>,<span style=color:#e6db74>&#34;sentenceno&#34;</span>)) <span style=color:#f92672>%&gt;%</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>left_join</span>(sentiment_score_df_sentence,by<span style=color:#f92672>=</span><span style=color:#a6e22e>c</span>(<span style=color:#e6db74>&#34;line&#34;</span>,<span style=color:#e6db74>&#34;sentenceno&#34;</span>))
</span></span><span style=display:flex><span>positive_lines_df_sentences
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>negative_lines_df_sentences <span style=color:#f92672>&lt;-</span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>unique</span>(negative_lines_df[,<span style=color:#ae81ff>1</span><span style=color:#f92672>:</span><span style=color:#ae81ff>3</span>]) <span style=color:#f92672>%&gt;%</span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>left_join</span>(AZDF02,by<span style=color:#f92672>=</span><span style=color:#a6e22e>c</span>(<span style=color:#e6db74>&#34;line&#34;</span>,<span style=color:#e6db74>&#34;sentenceno&#34;</span>)) <span style=color:#f92672>%&gt;%</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>left_join</span>(sentiment_score_df_sentence,by<span style=color:#f92672>=</span><span style=color:#a6e22e>c</span>(<span style=color:#e6db74>&#34;line&#34;</span>,<span style=color:#e6db74>&#34;sentenceno&#34;</span>))
</span></span><span style=display:flex><span>negative_lines_df_sentences
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>sentiment_line_df_sentences <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>rbind</span>(positive_lines_df_sentences,negative_lines_df_sentences)
</span></span><span style=display:flex><span><span style=color:#75715e>#--------------------------------------------------------</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#----------------  frequency/counts of words------------</span>
</span></span><span style=display:flex><span>positive_tokens_count <span style=color:#f92672>&lt;-</span> positive_lines_df <span style=color:#f92672>%&gt;%</span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>anti_join</span>(stopwords) <span style=color:#f92672>%&gt;%</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>#filter(chapter == cpt) %&gt;%</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>group_by</span>(word) <span style=color:#f92672>%&gt;%</span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>summarise</span>(n <span style=color:#f92672>=</span> <span style=color:#a6e22e>n</span>()) <span style=color:#f92672>%&gt;%</span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>filter</span>(n <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>%&gt;%</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>arrange</span>(<span style=color:#a6e22e>desc</span>(n))
</span></span><span style=display:flex><span><span style=color:#a6e22e>wordcloud2</span>(positive_tokens_count)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>negative_tokens_count <span style=color:#f92672>&lt;-</span> negative_lines_df <span style=color:#f92672>%&gt;%</span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>anti_join</span>(stopwords) <span style=color:#f92672>%&gt;%</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>#filter(chapter == cpt) %&gt;%</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>group_by</span>(word) <span style=color:#f92672>%&gt;%</span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>summarise</span>(sum <span style=color:#f92672>=</span> <span style=color:#a6e22e>n</span>()) <span style=color:#f92672>%&gt;%</span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>filter</span>(sum <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>%&gt;%</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>arrange</span>(<span style=color:#a6e22e>desc</span>(sum))
</span></span><span style=display:flex><span><span style=color:#a6e22e>wordcloud2</span>(negative_tokens_count)
</span></span><span style=display:flex><span><span style=color:#75715e>#----------- 讀取構面特徵關鍵字---------------------------</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#setwd(&#34;c:/SIDRWEB/DIMS/&#34;)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#dimfilename &lt;- &#34;dimfile.csv&#34;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#diminfo &lt;- fread(file=dimfilename,sep = &#34;,&#34; ,encoding=&#34;UTF-8&#34;,headeRFALSE, stringsAsFactors=FALSE)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#dimensions &lt;- diminfo$V1</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#------------------Local Testing-------------------------</span>
</span></span><span style=display:flex><span>selfdim_file_name <span style=color:#f92672>&lt;-</span><span style=color:#e6db74>&#39;3JDim.xlsx&#39;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#------------------Local Testing-------------------------</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(readxl)
</span></span><span style=display:flex><span>selfdimfile <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>read_excel</span>(selfdim_file_name)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span>(dim_name <span style=color:#66d9ef>in</span> <span style=color:#a6e22e>unique</span>(selfdimfile<span style=color:#f92672>$</span>Dimension)){
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  x <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>subset</span>( selfdimfile<span style=color:#a6e22e>[which</span>(selfdimfile<span style=color:#f92672>$</span>Dimension <span style=color:#f92672>==</span> dim_name) , <span style=color:#ae81ff>2</span> ])
</span></span><span style=display:flex><span>  <span style=color:#75715e>#dimtxtname = paste0( selfdim_path,&#34;/&#34;,dim_name, &#34;.txt&#34;)</span>
</span></span><span style=display:flex><span>  dimtxtname <span style=color:#f92672>=</span> dim_name
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>write.table</span>(x,
</span></span><span style=display:flex><span>              file <span style=color:#f92672>=</span> dimtxtname,
</span></span><span style=display:flex><span>              row.names <span style=color:#f92672>=</span> <span style=color:#66d9ef>FALSE</span>,
</span></span><span style=display:flex><span>              col.names <span style=color:#f92672>=</span> <span style=color:#66d9ef>FALSE</span>,
</span></span><span style=display:flex><span>              quote <span style=color:#f92672>=</span> <span style=color:#66d9ef>FALSE</span>,
</span></span><span style=display:flex><span>              sep <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;\t&#34;</span>)}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>dimensions <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>unique</span>(selfdimfile<span style=color:#f92672>$</span>Dimension)
</span></span><span style=display:flex><span><span style=color:#75715e>#------------------ Aspect / Dimensional ?i??-------------------------</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#setwd(&#34;c:/Koong/csv/DataScience/SERVQ&#34;)</span>
</span></span><span style=display:flex><span>sentiment_words_df_words <span style=color:#f92672>&lt;-</span> sentiment_score_df_sentence <span style=color:#f92672>%&gt;%</span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>left_join</span>(text_dataset,by<span style=color:#f92672>=</span> <span style=color:#a6e22e>c</span>(<span style=color:#e6db74>&#34;line&#34;</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;line&#34;</span>, <span style=color:#e6db74>&#34;sentenceno&#34;</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;sentenceno&#34;</span>))
</span></span><span style=display:flex><span>sentiment_words_df_words
</span></span><span style=display:flex><span>score_of_dimensions <span style=color:#f92672>&lt;-</span> <span style=color:#66d9ef>NULL</span>
</span></span><span style=display:flex><span>score_of_dimensions <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>lapply</span>(dimensions, 
</span></span><span style=display:flex><span>                              FUN<span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span>(x){
</span></span><span style=display:flex><span>                                dimname <span style=color:#f92672>&lt;-</span> x
</span></span><span style=display:flex><span>                                dimname
</span></span><span style=display:flex><span>                                x <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>fread</span>(file<span style=color:#f92672>=</span>x,encoding<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;UTF-8&#34;</span>,headeRFALSE, stringsAsFactors<span style=color:#f92672>=</span><span style=color:#66d9ef>FALSE</span>)
</span></span><span style=display:flex><span>                                <span style=color:#a6e22e>colnames</span>(x) <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>c</span>(<span style=color:#e6db74>&#34;word&#34;</span>)
</span></span><span style=display:flex><span>                                anz_words <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>tolower</span>(x<span style=color:#f92672>$</span>word)
</span></span><span style=display:flex><span>                                sentiment_DF <span style=color:#f92672>&lt;-</span> sentiment_words_df_words <span style=color:#f92672>%&gt;%</span> 
</span></span><span style=display:flex><span>                                  <span style=color:#a6e22e>filter</span>(word <span style=color:#f92672>%in%</span> anz_words) <span style=color:#f92672>%&gt;%</span>
</span></span><span style=display:flex><span>                                  <span style=color:#75715e>#------------?O?_?????葖??A?p??---------</span>
</span></span><span style=display:flex><span>                                <span style=color:#a6e22e>filter</span>(<span style=color:#a6e22e>as.numeric</span>(sentiment) <span style=color:#f92672>!=</span> <span style=color:#ae81ff>0</span>) <span style=color:#f92672>%&gt;%</span> 
</span></span><span style=display:flex><span>                                  <span style=color:#75715e>#-------------------------------------------</span>
</span></span><span style=display:flex><span>                                <span style=color:#a6e22e>mutate</span>(dimname <span style=color:#f92672>=</span> dimname) <span style=color:#f92672>%&gt;%</span>  
</span></span><span style=display:flex><span>                                  <span style=color:#a6e22e>arrange</span>(line) <span style=color:#75715e>#%&gt;%</span>
</span></span><span style=display:flex><span>                                <span style=color:#75715e>#   summarise(sentiment=mean(as.numeric(sentiment))) </span>
</span></span><span style=display:flex><span>                                <span style=color:#75715e># return(summarise(sentiment_DF, sscore =mean(sentiment)))</span>
</span></span><span style=display:flex><span>                              }
</span></span><span style=display:flex><span>                              
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>sdf <span style=color:#f92672>&lt;-</span> <span style=color:#66d9ef>NULL</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> (i <span style=color:#66d9ef>in</span> <span style=color:#ae81ff>1</span><span style=color:#f92672>:</span><span style=color:#a6e22e>length</span>(score_of_dimensions)) {
</span></span><span style=display:flex><span>  sdf <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>rbind</span>(<span style=color:#a6e22e>as.data.frame</span>(sdf),<span style=color:#a6e22e>as.data.frame</span>(score_of_dimensions[[i]]))
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>feature_words_df <span style=color:#f92672>&lt;-</span> 
</span></span><span style=display:flex><span>  sdf <span style=color:#f92672>%&gt;%</span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>left_join</span>(sentiment_line_df_sentences,by<span style=color:#f92672>=</span><span style=color:#a6e22e>c</span>(<span style=color:#e6db74>&#34;line&#34;</span>,<span style=color:#e6db74>&#34;sentenceno&#34;</span>)) <span style=color:#f92672>%&gt;%</span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>arrange</span>(line)
</span></span><span style=display:flex><span>feature_words_df <span style=color:#f92672>&lt;-</span> feature_words_df[,<span style=color:#ae81ff>-8</span>]
</span></span><span style=display:flex><span>feature_words_df <span style=color:#f92672>&lt;-</span> feature_words_df[,<span style=color:#ae81ff>-6</span>]
</span></span><span style=display:flex><span><span style=color:#75715e>#--------------------------------------------------------</span>
</span></span><span style=display:flex><span>score_of_dim <span style=color:#f92672>&lt;-</span> feature_words_df <span style=color:#f92672>%&gt;%</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>filter</span>(<span style=color:#a6e22e>as.numeric</span>(sentiment) <span style=color:#f92672>!=</span> <span style=color:#ae81ff>0</span>) <span style=color:#f92672>%&gt;%</span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>group_by</span>(dimname) <span style=color:#f92672>%&gt;%</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>summarise</span>(sentiment<span style=color:#f92672>=</span><span style=color:#a6e22e>mean</span>(<span style=color:#a6e22e>as.numeric</span>(sentiment))) 
</span></span><span style=display:flex><span>score_of_dim
</span></span><span style=display:flex><span><span style=color:#75715e>#-----------Bar Plot -------------------------------------------------------------</span>
</span></span><span style=display:flex><span>sent.score <span style=color:#f92672>&lt;-</span> score_of_dim<span style=color:#f92672>$</span>sentiment
</span></span><span style=display:flex><span><span style=color:#a6e22e>names</span>(sent.score) <span style=color:#f92672>&lt;-</span> score_of_dim<span style=color:#f92672>$</span>dimname
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>colorBlind.8 <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>c</span>( orange<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;#E69F00&#34;</span>, skyblue<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;#56B4E9&#34;</span>, bluegreen<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;#009E73&#34;</span>,
</span></span><span style=display:flex><span>                   yellow<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;#F0E442&#34;</span>, blue<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;#0072B2&#34;</span>, reddish<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;#D55E00&#34;</span>, 
</span></span><span style=display:flex><span>                   purplish<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;#CC79A7&#34;</span>,black<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;#000099&#34;</span>,green<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;#38D57D&#34;</span>,
</span></span><span style=display:flex><span>                   green01<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;#B9CC57&#34;</span>,yellow01<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;#FFFF00&#34;</span>, PINK<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;#FF9999&#34;</span>)
</span></span><span style=display:flex><span>cols <span style=color:#f92672>&lt;-</span> colorBlind.8[1<span style=color:#f92672>:</span><span style=color:#a6e22e>length</span>(sent.score)]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>barplot</span>(sent.score, xlab<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Dimensions&#34;</span>, 
</span></span><span style=display:flex><span>        ylab<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;score of sentiment&#34;</span>,
</span></span><span style=display:flex><span>        col <span style=color:#f92672>=</span> cols,
</span></span><span style=display:flex><span>        cex.axis<span style=color:#f92672>=</span><span style=color:#ae81ff>0.6</span>,
</span></span><span style=display:flex><span>        cex.names <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.6</span>)
</span></span><span style=display:flex><span><span style=color:#75715e>#-----------IPA OLD OK-----------------------------------------------------------------</span>
</span></span><span style=display:flex><span>ipa1 <span style=color:#f92672>&lt;-</span> <span style=color:#66d9ef>NULL</span>
</span></span><span style=display:flex><span>ipa1 <span style=color:#f92672>&lt;-</span> feature_words_df <span style=color:#f92672>%&gt;%</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>group_by</span>(dimname) <span style=color:#f92672>%&gt;%</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>summarise</span>(count <span style=color:#f92672>=</span> <span style=color:#a6e22e>n</span>()) <span style=color:#f92672>%&gt;%</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>left_join</span>(score_of_dim, by<span style=color:#f92672>=</span><span style=color:#a6e22e>c</span>(<span style=color:#e6db74>&#34;dimname&#34;</span>)) <span style=color:#f92672>%&gt;%</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>mutate</span>( cmove <span style=color:#f92672>=</span> count <span style=color:#f92672>-</span> <span style=color:#a6e22e>mean</span>(count) ) <span style=color:#f92672>%&gt;%</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>mutate</span>( smove <span style=color:#f92672>=</span> sentiment <span style=color:#f92672>-</span> <span style=color:#a6e22e>mean</span>(sentiment )) <span style=color:#f92672>%&gt;%</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>data.frame</span>() 
</span></span><span style=display:flex><span><span style=color:#75715e>#----------------------------------------------------------</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#--------------------------------------------------------------------</span>
</span></span><span style=display:flex><span>ipa <span style=color:#f92672>&lt;-</span> ipa1
</span></span><span style=display:flex><span><span style=color:#75715e>#--------IPA1 GGplot OK---------------------------------------------------------</span>
</span></span><span style=display:flex><span>empty_theme <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>theme</span>(                              
</span></span><span style=display:flex><span>  plot.background <span style=color:#f92672>=</span> <span style=color:#a6e22e>element_blank</span>(), 
</span></span><span style=display:flex><span>  panel.grid.major <span style=color:#f92672>=</span> <span style=color:#a6e22e>element_blank</span>(), 
</span></span><span style=display:flex><span>  panel.grid.minor <span style=color:#f92672>=</span> <span style=color:#a6e22e>element_blank</span>(), 
</span></span><span style=display:flex><span>  panel.border <span style=color:#f92672>=</span> <span style=color:#a6e22e>element_blank</span>(), 
</span></span><span style=display:flex><span>  panel.background <span style=color:#f92672>=</span> <span style=color:#a6e22e>element_blank</span>(),
</span></span><span style=display:flex><span>  axis.line <span style=color:#f92672>=</span> <span style=color:#a6e22e>element_blank</span>(),
</span></span><span style=display:flex><span>  axis.ticks <span style=color:#f92672>=</span> <span style=color:#a6e22e>element_blank</span>(),
</span></span><span style=display:flex><span>  axis.text.y <span style=color:#f92672>=</span> <span style=color:#a6e22e>element_text</span>(angle <span style=color:#f92672>=</span> <span style=color:#ae81ff>90</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#setwd(&#34;/home/jodytsao/public_html/SDTACD&#34;)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#IPAfilename &lt;- paste(currenttime,&#34;IPA.png&#34;, sep=&#39;&#39;)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#png(filename=IPAfilename)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#----------------------------------------------------------</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#ggplot(&lt;資料&gt;)+ # 設置畫布 </span>
</span></span><span style=display:flex><span><span style=color:#75715e>#  geom_&lt;幾何圖示類型&gt;( # 畫上幾何圖示 </span>
</span></span><span style=display:flex><span><span style=color:#75715e>#                aes(&lt;座標對應&gt;) #座標對應</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#  )</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#-----------------------------------------------------------</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>ggplot</span>(ipa, <span style=color:#a6e22e>aes</span>(x <span style=color:#f92672>=</span> smove, y <span style=color:#f92672>=</span> cmove, label <span style=color:#f92672>=</span> dimname)) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>#ggplot(ipa, aes(y = cmove, x = smove, label = word)) +</span>
</span></span><span style=display:flex><span>  empty_theme <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>theme</span>(panel.border <span style=color:#f92672>=</span> <span style=color:#a6e22e>element_rect</span>(colour <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;lightgrey&#34;</span>, fill<span style=color:#f92672>=</span><span style=color:#66d9ef>NA</span>, size<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>))<span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>labs</span>(title <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;IPA analysis&#34;</span>, y <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Counts of Dimension Sentences&#34;</span>, x <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Sentiment Score of Dimension&#34;</span>) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>geom_vline</span>(xintercept <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>, colour <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;lightgrey&#34;</span>, size<span style=color:#f92672>=</span><span style=color:#ae81ff>0.5</span>) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>geom_hline</span>(yintercept <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>, colour <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;lightgrey&#34;</span>, size<span style=color:#f92672>=</span><span style=color:#ae81ff>0.5</span>) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>geom_point</span>( size <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.5</span>)<span style=color:#f92672>+</span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>geom_label_repel</span>(size <span style=color:#f92672>=</span> <span style=color:#ae81ff>4</span>, fill <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;deepskyblue&#34;</span>, colour <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;black&#34;</span>, min.segment.length <span style=color:#f92672>=</span> <span style=color:#a6e22e>unit</span>(<span style=color:#ae81ff>0</span>, <span style=color:#e6db74>&#34;lines&#34;</span>)) 
</span></span><span style=display:flex><span>plot
</span></span><span style=display:flex><span><span style=color:#75715e>#dev.off()</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#-----------------------------------------</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#-----------  all words ------------------</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#--------------------------------------------------------------------------------</span>
</span></span><span style=display:flex><span>ipa3 <span style=color:#f92672>&lt;-</span> <span style=color:#66d9ef>NULL</span>
</span></span><span style=display:flex><span>ipa3 <span style=color:#f92672>&lt;-</span> sentiment_words_df <span style=color:#f92672>%&gt;%</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>group_by</span>(word) <span style=color:#f92672>%&gt;%</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>summarise</span>(sentiment <span style=color:#f92672>=</span> <span style=color:#a6e22e>mean</span>(sentiment),count <span style=color:#f92672>=</span> <span style=color:#a6e22e>n</span>()) <span style=color:#f92672>%&gt;%</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>filter</span>( count <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>20</span>) <span style=color:#f92672>%&gt;%</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>mutate</span>( cmove <span style=color:#f92672>=</span> count <span style=color:#f92672>-</span> <span style=color:#a6e22e>mean</span>(count) ) <span style=color:#f92672>%&gt;%</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>mutate</span>( smove <span style=color:#f92672>=</span> sentiment <span style=color:#f92672>-</span> <span style=color:#a6e22e>mean</span>(sentiment )) <span style=color:#f92672>%&gt;%</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>data.frame</span>() 
</span></span><span style=display:flex><span><span style=color:#75715e>#--------------------------------------------------------------------</span>
</span></span><span style=display:flex><span>ipa <span style=color:#f92672>&lt;-</span> ipa3
</span></span><span style=display:flex><span><span style=color:#75715e>#----------------------------------------------------------------------</span>
</span></span><span style=display:flex><span>empty_theme <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>theme</span>(                              
</span></span><span style=display:flex><span>  plot.background <span style=color:#f92672>=</span> <span style=color:#a6e22e>element_blank</span>(), 
</span></span><span style=display:flex><span>  panel.grid.major <span style=color:#f92672>=</span> <span style=color:#a6e22e>element_blank</span>(), 
</span></span><span style=display:flex><span>  panel.grid.minor <span style=color:#f92672>=</span> <span style=color:#a6e22e>element_blank</span>(), 
</span></span><span style=display:flex><span>  panel.border <span style=color:#f92672>=</span> <span style=color:#a6e22e>element_blank</span>(), 
</span></span><span style=display:flex><span>  panel.background <span style=color:#f92672>=</span> <span style=color:#a6e22e>element_blank</span>(),
</span></span><span style=display:flex><span>  axis.line <span style=color:#f92672>=</span> <span style=color:#a6e22e>element_blank</span>(),
</span></span><span style=display:flex><span>  axis.ticks <span style=color:#f92672>=</span> <span style=color:#a6e22e>element_blank</span>(),
</span></span><span style=display:flex><span>  axis.text.y <span style=color:#f92672>=</span> <span style=color:#a6e22e>element_text</span>(angle <span style=color:#f92672>=</span> <span style=color:#ae81ff>90</span>))
</span></span><span style=display:flex><span><span style=color:#a6e22e>ggplot</span>(ipa, <span style=color:#a6e22e>aes</span>(y <span style=color:#f92672>=</span> cmove, x <span style=color:#f92672>=</span> smove, label <span style=color:#f92672>=</span> word)) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>  empty_theme <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>theme</span>(panel.border <span style=color:#f92672>=</span> <span style=color:#a6e22e>element_rect</span>(colour <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;lightgrey&#34;</span>, fill<span style=color:#f92672>=</span><span style=color:#66d9ef>NA</span>, size<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>))<span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>labs</span>(title <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;IPA analysis&#34;</span> , x <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Sentiment Score of Word&#34;</span>, y <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Counts of Word&#34;</span>) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>geom_vline</span>(xintercept <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>, colour <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;lightgrey&#34;</span>, size<span style=color:#f92672>=</span><span style=color:#ae81ff>0.5</span>) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>geom_hline</span>(yintercept <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>, colour <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;lightgrey&#34;</span>, size<span style=color:#f92672>=</span><span style=color:#ae81ff>0.5</span>) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>geom_text_repel</span>(max.overlaps <span style=color:#f92672>=</span> <span style=color:#66d9ef>Inf</span>)<span style=color:#f92672>+</span> <span style=color:#75715e>#always show all labels even overlap</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>geom_point</span>( size <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.5</span>) 
</span></span></code></pre></div><div class=embed-pdf-container id=embed-pdf-container-73b16643><div class=pdf-loadingWrapper id=pdf-loadingWrapper-73b16643><div class=pdf-loading id=pdf-loading-73b16643></div></div><div id=overlayText><a href=/files/R%e8%aa%9e%e8%a8%80%e8%a7%a3%e6%9e%90_Part_One.pdf aria-label=Download download><svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18"><path d="M9 13c.3.0.5-.1.7-.3L15.4 7 14 5.6l-4 4V1H8v8.6l-4-4L2.6 7l5.7 5.7c.2.2.4.3.7.3zm-7 2h14v2H2z"/></svg></a></div><canvas class=pdf-canvas id=pdf-canvas-73b16643></canvas></div><div class=pdf-paginator id=pdf-paginator-73b16643><button id=pdf-prev-73b16643>上一頁 </button>&nbsp;&nbsp;
<button id=pdf-next-73b16643>下一頁 </button> &nbsp; &nbsp;
<span><span class=pdf-pagenum id=pdf-pagenum-73b16643></span> / <span class=pdf-pagecount id=pdf-pagecount-73b16643></span>
</span>&nbsp;
<a class=pdf-source id=pdf-source-73b16643 href=/files/R%e8%aa%9e%e8%a8%80%e8%a7%a3%e6%9e%90_Part_One.pdf>[ 檢視PDF全文 ]</a></div><noscript>View the PDF file <a class=pdf-source id=pdf-source-noscript-73b16643 href=/files/R%e8%aa%9e%e8%a8%80%e8%a7%a3%e6%9e%90_Part_One.pdf>here</a>.</noscript><script type=text/javascript>(function(){c="/files/R語言解析_Part_One.pdf",u=""==="true",l=""==="true",h=parseInt("")||1,s=window["pdfjs-dist/build/pdf"],s.GlobalWorkerOptions.workerSrc==""&&(s.GlobalWorkerOptions.workerSrc="https://aimv.sidrlab.net/js/pdf-js/build/pdf.worker.js");var s,c,l,u,h,n=null,e=h,i=!1,o=null,b=3,t=document.getElementById("pdf-canvas-73b16643"),m=t.getContext("2d"),f=document.getElementById("pdf-paginator-73b16643"),r=document.getElementById("pdf-loadingWrapper-73b16643");v(),g();function a(e){i=!0,n.getPage(e).then(function(e){var s,r,n=e.getViewport({scale:b});t.height=n.height,t.width=n.width,s={canvasContext:m,viewport:n},r=e.render(s),r.promise.then(function(){i=!1,p(),o!==null&&(a(o),o=null)})}),document.getElementById("pdf-pagenum-73b16643").textContent=e}function p(){r.style.display="none",t.style.display="block"}function g(){if(l)return;r.style.display="flex",t.style.display="none"}function v(){if(u)return;f.style.display="block"}function d(e){i?o=e:a(e)}function j(){if(e<=1)return;e--,d(e)}document.getElementById("pdf-prev-73b16643").addEventListener("click",j);function y(){if(e>=n.numPages)return;e++,d(e)}document.getElementById("pdf-next-73b16643").addEventListener("click",y),s.getDocument(c).promise.then(function(t){n=t;var s=n.numPages;document.getElementById("pdf-pagecount-73b16643").textContent=s,e>s&&(e=s),a(e)})})()</script><hr><h2 id=20240416>20240416</h2><p>1.策略調色盤之策略選擇分析影片
<a href="https://youtube.com/playlist?list=PLYRFygSk3wHB_MFivSr71ug6dO_6uL7IH&amp;si=LEH6YQOO4kx6FMNy" target=_blank>https://youtube.com/playlist?list=PLYRFygSk3wHB_MFivSr71ug6dO_6uL7IH&si=LEH6YQOO4kx6FMNy</a></p><p>2.策略調色盤之策略選擇分析練習(小組作業)</p><p>3.觀看過"1.策略調色盤之策略選擇分析影片"後，試著填答
&ldquo;市場策略分析策略調色盤_練習.docx"這三個問題
分別以三個集團(ZARA，Tesla, 以及Coca Cola) 為例，根據其旗下的品牌，分別:回答下列問題:</p><ol><li>請選擇最符合你當前策略的描述 從 ABCDE中選擇一個您的看法</li><li>請選擇最符合你認為的商業環境的描述。從 FGHIJ中選擇一個您的看法</li><li>你想要採用的策略是什麼?從 KLMNO選擇一個您的看法</li><li>上傳小組討論的看法: ex:
ZARA: A,F,K
Telsa: B,G,L
Coca Cola: C,H,M
針對: Netflix :串流平台 自製影片 為例來回答</li></ol><hr><h2 id=20240424-對應分析>20240424 對應分析</h2><p><a href=https://www.displayr.com/how-correspondence-analysis-works/ target=_blank>(1) A Simple Explanation of how Correspondence Analysis Works</a></p><p><a href=https://www.xlstat.com/en/download target=_blank>(2) XLSTAT</a></p><h3 id=python程式碼請自行確認是否能運作>Python程式碼(請自行確認是否能運作)</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># 匯入所需的函式庫</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> pandas <span style=color:#66d9ef>as</span> pd
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> sklearn.preprocessing <span style=color:#f92672>import</span> StandardScaler
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> sklearn.decomposition <span style=color:#f92672>import</span> PCA
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> matplotlib.pyplot <span style=color:#66d9ef>as</span> plt
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> seaborn <span style=color:#66d9ef>as</span> sns
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> scipy.stats <span style=color:#f92672>import</span> chi2_contingency
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 設定工作目錄</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span>os<span style=color:#f92672>.</span>chdir(<span style=color:#e6db74>&#34;D:/Koong/csv/&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 讀取 csv 檔案</span>
</span></span><span style=display:flex><span>mobile <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>read_csv(<span style=color:#e6db74>&#34;mobile.csv&#34;</span>, index_col<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 檢查資料集的前幾列</span>
</span></span><span style=display:flex><span>print(mobile<span style=color:#f92672>.</span>head())
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 進行卡方檢定</span>
</span></span><span style=display:flex><span>chi2, p, dof, ex <span style=color:#f92672>=</span> chi2_contingency(mobile)
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Chi-square: </span><span style=color:#e6db74>{</span>chi2<span style=color:#e6db74>}</span><span style=color:#e6db74>, p-value: </span><span style=color:#e6db74>{</span>p<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 執行對應分析</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> prince <span style=color:#f92672>import</span> CA
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ca <span style=color:#f92672>=</span> CA(n_components<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>ca <span style=color:#f92672>=</span> ca<span style=color:#f92672>.</span>fit(mobile)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 獲取特徵值/方差</span>
</span></span><span style=display:flex><span>eig_val <span style=color:#f92672>=</span> ca<span style=color:#f92672>.</span>eigenvalues_
</span></span><span style=display:flex><span>print(eig_val)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 畫 Scree Plot</span>
</span></span><span style=display:flex><span>sns<span style=color:#f92672>.</span>set(style<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;whitegrid&#34;</span>)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>figure(figsize<span style=color:#f92672>=</span>(<span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>6</span>))
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>bar(range(<span style=color:#ae81ff>1</span>, len(eig_val) <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>), eig_val, alpha<span style=color:#f92672>=</span><span style=color:#ae81ff>0.5</span>, align<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;center&#39;</span>, label<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;individual explained variance&#39;</span>)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>step(range(<span style=color:#ae81ff>1</span>, len(eig_val) <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>), eig_val<span style=color:#f92672>.</span>cumsum(), where<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;mid&#39;</span>, label<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;cumulative explained variance&#39;</span>)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>ylabel(<span style=color:#e6db74>&#39;Explained variance ratio&#39;</span>)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>xlabel(<span style=color:#e6db74>&#39;Principal components&#39;</span>)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>title(<span style=color:#e6db74>&#39;Scree Plot&#39;</span>)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>axhline(y<span style=color:#f92672>=</span><span style=color:#ae81ff>33.33</span>, coloR<span style=color:#e6db74>&#39;r&#39;</span>, linestyle<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;--&#39;</span>)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>legend(loc<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;best&#39;</span>)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>show()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 畫 Biplot</span>
</span></span><span style=display:flex><span>fig, ax <span style=color:#f92672>=</span> plt<span style=color:#f92672>.</span>subplots(figsize<span style=color:#f92672>=</span>(<span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>8</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 取得行與列的座標</span>
</span></span><span style=display:flex><span>row_coords <span style=color:#f92672>=</span> ca<span style=color:#f92672>.</span>row_coordinates(mobile)
</span></span><span style=display:flex><span>col_coords <span style=color:#f92672>=</span> ca<span style=color:#f92672>.</span>column_coordinates(mobile)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 繪製行的點</span>
</span></span><span style=display:flex><span>ax<span style=color:#f92672>.</span>scatter(row_coords[<span style=color:#ae81ff>0</span>], row_coords[<span style=color:#ae81ff>1</span>], alpha<span style=color:#f92672>=</span><span style=color:#ae81ff>0.5</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i, txt <span style=color:#f92672>in</span> enumerate(row_coords<span style=color:#f92672>.</span>index):
</span></span><span style=display:flex><span>    ax<span style=color:#f92672>.</span>annotate(txt, (row_coords[<span style=color:#ae81ff>0</span>][i], row_coords[<span style=color:#ae81ff>1</span>][i]), alpha<span style=color:#f92672>=</span><span style=color:#ae81ff>0.75</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 繪製列的點</span>
</span></span><span style=display:flex><span>ax<span style=color:#f92672>.</span>scatter(col_coords[<span style=color:#ae81ff>0</span>], col_coords[<span style=color:#ae81ff>1</span>], alpha<span style=color:#f92672>=</span><span style=color:#ae81ff>0.5</span>, coloR<span style=color:#e6db74>&#39;red&#39;</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i, txt <span style=color:#f92672>in</span> enumerate(col_coords<span style=color:#f92672>.</span>index):
</span></span><span style=display:flex><span>    ax<span style=color:#f92672>.</span>annotate(txt, (col_coords[<span style=color:#ae81ff>0</span>][i], col_coords[<span style=color:#ae81ff>1</span>][i]), alpha<span style=color:#f92672>=</span><span style=color:#ae81ff>0.75</span>, coloR<span style=color:#e6db74>&#39;red&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ax<span style=color:#f92672>.</span>set_xlabel(<span style=color:#e6db74>&#39;Dimension 1&#39;</span>)
</span></span><span style=display:flex><span>ax<span style=color:#f92672>.</span>set_ylabel(<span style=color:#e6db74>&#39;Dimension 2&#39;</span>)
</span></span><span style=display:flex><span>ax<span style=color:#f92672>.</span>set_title(<span style=color:#e6db74>&#39;Correspondence Analysis Biplot&#39;</span>)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>grid()
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>show()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 繪製行的貢獻圖</span>
</span></span><span style=display:flex><span>row_contrib <span style=color:#f92672>=</span> ca<span style=color:#f92672>.</span>row_contributions(mobile)
</span></span><span style=display:flex><span>top_contrib1 <span style=color:#f92672>=</span> row_contrib[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>.</span>nlargest(<span style=color:#ae81ff>10</span>)
</span></span><span style=display:flex><span>top_contrib2 <span style=color:#f92672>=</span> row_contrib[<span style=color:#ae81ff>1</span>]<span style=color:#f92672>.</span>nlargest(<span style=color:#ae81ff>10</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>figure(figsize<span style=color:#f92672>=</span>(<span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>6</span>))
</span></span><span style=display:flex><span>sns<span style=color:#f92672>.</span>barplot(x<span style=color:#f92672>=</span>top_contrib1<span style=color:#f92672>.</span>values, y<span style=color:#f92672>=</span>top_contrib1<span style=color:#f92672>.</span>index, palette<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;viridis&#34;</span>)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>title(<span style=color:#e6db74>&#39;Top 10 Contributions of Rows to Dimension 1&#39;</span>)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>xlabel(<span style=color:#e6db74>&#39;Contribution&#39;</span>)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>ylabel(<span style=color:#e6db74>&#39;Rows&#39;</span>)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>show()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>figure(figsize<span style=color:#f92672>=</span>(<span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>6</span>))
</span></span><span style=display:flex><span>sns<span style=color:#f92672>.</span>barplot(x<span style=color:#f92672>=</span>top_contrib2<span style=color:#f92672>.</span>values, y<span style=color:#f92672>=</span>top_contrib2<span style=color:#f92672>.</span>index, palette<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;viridis&#34;</span>)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>title(<span style=color:#e6db74>&#39;Top 10 Contributions of Rows to Dimension 2&#39;</span>)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>xlabel(<span style=color:#e6db74>&#39;Contribution&#39;</span>)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>ylabel(<span style=color:#e6db74>&#39;Rows&#39;</span>)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>show()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 繪製行的顏色根據貢獻度</span>
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>figure(figsize<span style=color:#f92672>=</span>(<span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>8</span>))
</span></span><span style=display:flex><span>sns<span style=color:#f92672>.</span>scatterplot(x<span style=color:#f92672>=</span>row_coords[<span style=color:#ae81ff>0</span>], y<span style=color:#f92672>=</span>row_coords[<span style=color:#ae81ff>1</span>], hue<span style=color:#f92672>=</span>row_contrib[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>+</span> row_contrib[<span style=color:#ae81ff>1</span>], palette<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;viridis&#34;</span>, legend<span style=color:#f92672>=</span><span style=color:#66d9ef>False</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i, txt <span style=color:#f92672>in</span> enumerate(row_coords<span style=color:#f92672>.</span>index):
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>annotate(txt, (row_coords[<span style=color:#ae81ff>0</span>][i], row_coords[<span style=color:#ae81ff>1</span>][i]), alpha<span style=color:#f92672>=</span><span style=color:#ae81ff>0.75</span>)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>xlabel(<span style=color:#e6db74>&#39;Dimension 1&#39;</span>)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>ylabel(<span style=color:#e6db74>&#39;Dimension 2&#39;</span>)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>title(<span style=color:#e6db74>&#39;Correspondence Analysis Biplot (Rows Colored by Contribution)&#39;</span>)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>grid()
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>show()
</span></span></code></pre></div><h3 id=r-語言程式碼>R 語言程式碼</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-R data-lang=R><span style=display:flex><span><span style=color:#a6e22e>library</span>(<span style=color:#e6db74>&#34;FactoMineR&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(<span style=color:#e6db74>&#34;factoextra&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>setwd</span>(<span style=color:#e6db74>&#34;D:/Koong/csv/&#34;</span>)
</span></span><span style=display:flex><span>mobile <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>read.csv</span>(<span style=color:#e6db74>&#34;mobile.csv&#34;</span>, stringsAsFactors <span style=color:#f92672>=</span> <span style=color:#66d9ef>TRUE</span>)
</span></span><span style=display:flex><span><span style=color:#a6e22e>colnames</span>(mobile) <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>c</span>(<span style=color:#66d9ef>NA</span>,<span style=color:#e6db74>&#34;Screen&#34;</span>,<span style=color:#e6db74>&#34;Price&#34;</span>,<span style=color:#e6db74>&#34;Design&#34;</span>,<span style=color:#e6db74>&#34;Battery&#34;</span>,<span style=color:#e6db74>&#34;Software&#34;</span>,<span style=color:#e6db74>&#34;Camera&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>he
</span></span><span style=display:flex><span><span style=color:#a6e22e>ad</span>(mobile)
</span></span><span style=display:flex><span><span style=color:#a6e22e>rownames</span>(mobile) <span style=color:#f92672>&lt;-</span> mobile[,<span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>mobile <span style=color:#f92672>&lt;-</span> mobile[,<span style=color:#ae81ff>-1</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#the association is highly significant (chi-square: 1944.456, p = 0).</span>
</span></span><span style=display:flex><span>chisq <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>chisq.test</span>(mobile)
</span></span><span style=display:flex><span>chisq
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#---------- compute CA ------------------</span>
</span></span><span style=display:flex><span>res.ca <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>CA</span>(mobile, graph <span style=color:#f92672>=</span> <span style=color:#66d9ef>FALSE</span>)
</span></span><span style=display:flex><span><span style=color:#a6e22e>print</span>(res.ca)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#Extract the eigenvalues/variances retained by each dimension (axis)</span>
</span></span><span style=display:flex><span>eig.val <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>get_eigenvalue</span>(res.ca)
</span></span><span style=display:flex><span>eig.val
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>fviz_screeplot</span>(res.ca, addlabels <span style=color:#f92672>=</span> <span style=color:#66d9ef>TRUE</span>, ylim <span style=color:#f92672>=</span> <span style=color:#a6e22e>c</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>50</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#------------  Biplot -------------------------------------</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>fviz_screeplot</span>(res.ca) <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>geom_hline</span>(yintercept<span style=color:#f92672>=</span><span style=color:#ae81ff>33.33</span>, linetype<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span>, coloR<span style=color:#e6db74>&#34;red&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># repel= TRUE to avoid text overlapping (slow if many point)</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>fviz_ca_biplot</span>(res.ca, repel <span style=color:#f92672>=</span> <span style=color:#66d9ef>TRUE</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#----------------------------------------------</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>fviz_ca_row</span>(res.ca, col.row <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;cos2&#34;</span>,
</span></span><span style=display:flex><span>            gradient.cols <span style=color:#f92672>=</span> <span style=color:#a6e22e>c</span>(<span style=color:#e6db74>&#34;#00AFBB&#34;</span>, <span style=color:#e6db74>&#34;#E7B800&#34;</span>, <span style=color:#e6db74>&#34;#FC4E07&#34;</span>), 
</span></span><span style=display:flex><span>            repel <span style=color:#f92672>=</span> <span style=color:#66d9ef>TRUE</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Contributions of rows to dimension 1</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>fviz_contrib</span>(res.ca, choice <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;row&#34;</span>, axes <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>, top <span style=color:#f92672>=</span> <span style=color:#ae81ff>10</span>)
</span></span><span style=display:flex><span><span style=color:#75715e># Contributions of rows to dimension 2</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>fviz_contrib</span>(res.ca, choice <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;row&#34;</span>, axes <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>, top <span style=color:#f92672>=</span> <span style=color:#ae81ff>10</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#--------------------------------------------------------</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>fviz_ca_row</span>(res.ca, col.row <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;contrib&#34;</span>,
</span></span><span style=display:flex><span>            gradient.cols <span style=color:#f92672>=</span> <span style=color:#a6e22e>c</span>(<span style=color:#e6db74>&#34;#00AFBB&#34;</span>, <span style=color:#e6db74>&#34;#E7B800&#34;</span>, <span style=color:#e6db74>&#34;#FC4E07&#34;</span>), 
</span></span><span style=display:flex><span>            repel <span style=color:#f92672>=</span> <span style=color:#66d9ef>TRUE</span>)
</span></span></code></pre></div><hr><h2 id=20240430>20240430</h2><p>Clustering Analysis / Segmentation</p><p>1.人口統計: USCity.xlsx / ClusterMean0501.R -> USCities.cvs</p><p>2.RFM分析: onlinestore1220.xlsx /ClusterSegment_0501.R onlinestore1220.csv</p><h3 id=cluster_k-means-r語言程式碼>Cluster_K-Means R語言程式碼</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-R data-lang=R><span style=display:flex><span><span style=color:#a6e22e>library</span>(cluster)
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(factoextra)
</span></span><span style=display:flex><span><span style=color:#75715e>#</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>setwd</span>(<span style=color:#e6db74>&#34;/home/jodytsao/DataScienceMarketing/csv/&#34;</span>)
</span></span><span style=display:flex><span>USCity <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>read.csv</span>(<span style=color:#e6db74>&#34;USCities.csv&#34;</span>)
</span></span><span style=display:flex><span>res.data01 <span style=color:#f92672>&lt;-</span> USCity[3<span style=color:#f92672>:</span><span style=color:#ae81ff>8</span>]
</span></span><span style=display:flex><span>USCityData <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>as.data.frame</span>(<span style=color:#a6e22e>scale</span>(res.data01))
</span></span><span style=display:flex><span><span style=color:#75715e>#--------------------------------------------------------------------------------</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span>(n_cluster <span style=color:#66d9ef>in</span> <span style=color:#ae81ff>2</span><span style=color:#f92672>:</span><span style=color:#ae81ff>8</span>){
</span></span><span style=display:flex><span>  cluster <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>kmeans</span>(USCityData, n_cluster)
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  silhouetteScore <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>mean</span>(
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>silhouette</span>(
</span></span><span style=display:flex><span>      cluster<span style=color:#f92672>$</span>cluster, 
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>dist</span>(USCityData, method <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;euclidean&#34;</span>)
</span></span><span style=display:flex><span>    )[,<span style=color:#ae81ff>3</span>]
</span></span><span style=display:flex><span>  )
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>print</span>(<span style=color:#a6e22e>sprintf</span>(<span style=color:#e6db74>&#39;Silhouette Score for %i Clusters: %0.4f&#39;</span>, n_cluster, silhouetteScore))
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#---------------------------------------------------------------------------------</span>
</span></span><span style=display:flex><span><span style=color:#75715e># for reproducibility</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>set.seed</span>(<span style=color:#ae81ff>123</span>) 
</span></span><span style=display:flex><span><span style=color:#75715e># Visualize</span>
</span></span><span style=display:flex><span>USCityDataClusterData <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>kmeans</span>(USCityData, <span style=color:#ae81ff>4</span>)
</span></span><span style=display:flex><span><span style=color:#75715e>#### 3. Customer Segmentation via K-Means Clustering ####</span>
</span></span><span style=display:flex><span><span style=color:#75715e># cluster centers</span>
</span></span><span style=display:flex><span>USCityDataClusterData<span style=color:#f92672>$</span>centers
</span></span><span style=display:flex><span><span style=color:#75715e># cluster labels </span>
</span></span><span style=display:flex><span>USCityCluster <span style=color:#f92672>&lt;-</span> USCity <span style=color:#f92672>%&gt;%</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>mutate</span>(ClusteRUSCityDataClusterData<span style=color:#f92672>$</span>cluster)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>USCityCluster <span style=color:#f92672>%&gt;%</span> <span style=color:#a6e22e>group_by</span>(Cluster) <span style=color:#f92672>%&gt;%</span> <span style=color:#a6e22e>summarise</span>(Count<span style=color:#f92672>=</span><span style=color:#a6e22e>n</span>())
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># High value cluster summary</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>summary</span>(USCityCluster <span style=color:#a6e22e>[which</span>(USCityCluster <span style=color:#f92672>$</span>Cluster <span style=color:#f92672>==</span> <span style=color:#ae81ff>4</span>),])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>USCityCluster<span style=color:#a6e22e>[which</span>(USCityCluster<span style=color:#f92672>$</span>CityNo <span style=color:#f92672>%in%</span> <span style=color:#a6e22e>which</span>(USCityCluster<span style=color:#f92672>$</span>Cluster <span style=color:#f92672>==</span> <span style=color:#ae81ff>3</span>)),] <span style=color:#f92672>%&gt;%</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>group_by</span>(City) 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>USCityCluster<span style=color:#a6e22e>[which</span>(USCityCluster<span style=color:#f92672>$</span>CityNo <span style=color:#f92672>%in%</span> <span style=color:#a6e22e>which</span>(USCityCluster<span style=color:#f92672>$</span>Cluster <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span>)),] <span style=color:#f92672>%&gt;%</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>group_by</span>(City) 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>USCityCluster<span style=color:#a6e22e>[which</span>(USCityCluster<span style=color:#f92672>$</span>CityNo <span style=color:#f92672>%in%</span> <span style=color:#a6e22e>which</span>(USCityCluster<span style=color:#f92672>$</span>Cluster <span style=color:#f92672>==</span> <span style=color:#ae81ff>2</span>)),] <span style=color:#f92672>%&gt;%</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>group_by</span>(City) 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>USCityCluster<span style=color:#a6e22e>[which</span>(USCityCluster<span style=color:#f92672>$</span>CityNo <span style=color:#f92672>%in%</span> <span style=color:#a6e22e>which</span>(USCityCluster<span style=color:#f92672>$</span>Cluster <span style=color:#f92672>==</span> <span style=color:#ae81ff>4</span>)),] <span style=color:#f92672>%&gt;%</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>group_by</span>(City) 
</span></span></code></pre></div><h3 id=customer-segmentation-r語言程式碼>Customer Segmentation R語言程式碼</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-R data-lang=R><span style=display:flex><span><span style=color:#a6e22e>library</span>(dplyr)
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(ggplot2)
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(cluster)
</span></span><span style=display:flex><span><span style=color:#75715e>#### 1. Load Data ####</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>setwd</span>(<span style=color:#e6db74>&#34;/home/jodytsao/DataScienceMarketing/&#34;</span>)
</span></span><span style=display:flex><span>df1<span style=color:#f92672>=</span><span style=color:#a6e22e>read.csv</span>(<span style=color:#e6db74>&#34;csv/OnlineStore1220.csv&#34;</span>,headeRTRUE,stringsAsFactors <span style=color:#f92672>=</span> <span style=color:#66d9ef>TRUE</span>)
</span></span><span style=display:flex><span>res.data01 <span style=color:#f92672>&lt;-</span> df1[3<span style=color:#f92672>:</span><span style=color:#ae81ff>5</span>]
</span></span><span style=display:flex><span>normalizedDF <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>as.data.frame</span>(<span style=color:#a6e22e>scale</span>(res.data01))
</span></span><span style=display:flex><span><span style=color:#75715e>#### 3. Customer Segmentation via K-Means Clustering ####</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>cluster <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>kmeans</span>(normalizedDF, <span style=color:#ae81ff>4</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># cluster centers</span>
</span></span><span style=display:flex><span>cluster<span style=color:#f92672>$</span>centers
</span></span><span style=display:flex><span><span style=color:#75715e># cluster labels</span>
</span></span><span style=display:flex><span><span style=color:#75715e># cluster labels </span>
</span></span><span style=display:flex><span>df2 <span style=color:#f92672>&lt;-</span> df1 <span style=color:#f92672>%&gt;%</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>mutate</span>(ClusteRcluster<span style=color:#f92672>$</span>cluster)
</span></span><span style=display:flex><span><span style=color:#75715e>#df2 %&gt;% group_by(Cluster) %&gt;% summarise(Count=n())</span>
</span></span><span style=display:flex><span>df2[df2<span style=color:#f92672>$</span>Cluster <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span>,] <span style=color:#f92672>%&gt;%</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>group_by</span>(CustomerID) 
</span></span><span style=display:flex><span><span style=color:#75715e>#---------------------------------------</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Selecting the best number of cluster</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#---------------------------------------</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span>(n_cluster <span style=color:#66d9ef>in</span> <span style=color:#ae81ff>2</span><span style=color:#f92672>:</span><span style=color:#ae81ff>8</span>){
</span></span><span style=display:flex><span>  cluster <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>kmeans</span>(normalizedDF<span style=color:#a6e22e>[c</span>(<span style=color:#e6db74>&#34;TotalSales&#34;</span>, <span style=color:#e6db74>&#34;OrderCount&#34;</span>, <span style=color:#e6db74>&#34;AvgOrderValue&#34;</span>)], n_cluster)
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  silhouetteScore <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>mean</span>(
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>silhouette</span>(
</span></span><span style=display:flex><span>      cluster<span style=color:#f92672>$</span>cluster, 
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>dist</span>(normalizedDF<span style=color:#a6e22e>[c</span>(<span style=color:#e6db74>&#34;TotalSales&#34;</span>, <span style=color:#e6db74>&#34;OrderCount&#34;</span>, <span style=color:#e6db74>&#34;AvgOrderValue&#34;</span>)], method <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;euclidean&#34;</span>)
</span></span><span style=display:flex><span>    )[,<span style=color:#ae81ff>3</span>]
</span></span><span style=display:flex><span>  )
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>print</span>(<span style=color:#a6e22e>sprintf</span>(<span style=color:#e6db74>&#39;Silhouette Score for %i Clusters: %0.4f&#39;</span>, n_cluster, silhouetteScore))
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#75715e>#---------------------------------------</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Selecting the best number of cluster</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#---------------------------------------</span>
</span></span></code></pre></div><h3 id=cluster_k-means-python程式碼請自行確認是否能運作>Cluster_K-Means Python程式碼(請自行確認是否能運作)</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># 匯入所需的函式庫</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> pandas <span style=color:#66d9ef>as</span> pd
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> sklearn.preprocessing <span style=color:#f92672>import</span> StandardScaler
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> sklearn.cluster <span style=color:#f92672>import</span> KMeans
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> sklearn.metrics <span style=color:#f92672>import</span> silhouette_score
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> numpy <span style=color:#66d9ef>as</span> np
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 設定工作目錄</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span>os<span style=color:#f92672>.</span>chdir(<span style=color:#e6db74>&#34;/home/jodytsao/DataScienceMarketing/csv/&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 讀取 csv 檔案</span>
</span></span><span style=display:flex><span>USCity <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>read_csv(<span style=color:#e6db74>&#34;USCities.csv&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 擷取所需的資料欄位並進行標準化</span>
</span></span><span style=display:flex><span>res_data01 <span style=color:#f92672>=</span> USCity<span style=color:#f92672>.</span>iloc[:, <span style=color:#ae81ff>2</span>:<span style=color:#ae81ff>8</span>]
</span></span><span style=display:flex><span>scaler <span style=color:#f92672>=</span> StandardScaler()
</span></span><span style=display:flex><span>USCityData <span style=color:#f92672>=</span> scaler<span style=color:#f92672>.</span>fit_transform(res_data01)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 計算不同群數的輪廓係數 (Silhouette Score)</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> n_cluster <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>9</span>):
</span></span><span style=display:flex><span>    kmeans <span style=color:#f92672>=</span> KMeans(n_clusters<span style=color:#f92672>=</span>n_cluster, random_state<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>    cluster_labels <span style=color:#f92672>=</span> kmeans<span style=color:#f92672>.</span>fit_predict(USCityData)
</span></span><span style=display:flex><span>    silhouette_avg <span style=color:#f92672>=</span> silhouette_score(USCityData, cluster_labels)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;Silhouette Score for </span><span style=color:#e6db74>{</span>n_cluster<span style=color:#e6db74>}</span><span style=color:#e6db74> Clusters: </span><span style=color:#e6db74>{</span>silhouette_avg<span style=color:#e6db74>:</span><span style=color:#e6db74>.4f</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 設置隨機種子以確保結果可重現</span>
</span></span><span style=display:flex><span>np<span style=color:#f92672>.</span>random<span style=color:#f92672>.</span>seed(<span style=color:#ae81ff>123</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 進行 K-means 聚類，使用 4 個群</span>
</span></span><span style=display:flex><span>kmeans <span style=color:#f92672>=</span> KMeans(n_clusters<span style=color:#f92672>=</span><span style=color:#ae81ff>4</span>, random_state<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>USCityDataClusterData <span style=color:#f92672>=</span> kmeans<span style=color:#f92672>.</span>fit(USCityData)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 聚類中心</span>
</span></span><span style=display:flex><span>print(USCityDataClusterData<span style=color:#f92672>.</span>cluster_centers_)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 加入群集標籤到原始資料中</span>
</span></span><span style=display:flex><span>USCity[<span style=color:#e6db74>&#39;Cluster&#39;</span>] <span style=color:#f92672>=</span> USCityDataClusterData<span style=color:#f92672>.</span>labels_
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 每個群集的數量統計</span>
</span></span><span style=display:flex><span>print(USCity<span style=color:#f92672>.</span>groupby(<span style=color:#e6db74>&#39;Cluster&#39;</span>)<span style=color:#f92672>.</span>size())
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 高價值群集的摘要統計</span>
</span></span><span style=display:flex><span>print(USCity[USCity[<span style=color:#e6db74>&#39;Cluster&#39;</span>] <span style=color:#f92672>==</span> <span style=color:#ae81ff>3</span>]<span style=color:#f92672>.</span>describe())
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 各群集內的城市名稱統計</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> cluster_num <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>4</span>):
</span></span><span style=display:flex><span>    cities_in_cluster <span style=color:#f92672>=</span> USCity[USCity[<span style=color:#e6db74>&#39;Cluster&#39;</span>] <span style=color:#f92672>==</span> cluster_num][<span style=color:#e6db74>&#39;City&#39;</span>]
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;Cities in Cluster </span><span style=color:#e6db74>{</span>cluster_num<span style=color:#e6db74>}</span><span style=color:#e6db74>:&#39;</span>)
</span></span><span style=display:flex><span>    print(cities_in_cluster)
</span></span></code></pre></div><h3 id=customer-segmentation-python程式碼請自行確認是否能運作>Customer Segmentation Python程式碼(請自行確認是否能運作)</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># 匯入所需的函式庫</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> pandas <span style=color:#66d9ef>as</span> pd
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> sklearn.preprocessing <span style=color:#f92672>import</span> StandardScaler
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> sklearn.cluster <span style=color:#f92672>import</span> KMeans
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> sklearn.metrics <span style=color:#f92672>import</span> silhouette_score
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> numpy <span style=color:#66d9ef>as</span> np
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 設定工作目錄</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span>os<span style=color:#f92672>.</span>chdir(<span style=color:#e6db74>&#34;/home/jodytsao/DataScienceMarketing/&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 讀取 csv 檔案</span>
</span></span><span style=display:flex><span>df1 <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>read_csv(<span style=color:#e6db74>&#34;csv/OnlineStore1220.csv&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 擷取所需的資料欄位並進行標準化</span>
</span></span><span style=display:flex><span>res_data01 <span style=color:#f92672>=</span> df1<span style=color:#f92672>.</span>iloc[:, <span style=color:#ae81ff>2</span>:<span style=color:#ae81ff>5</span>]
</span></span><span style=display:flex><span>scaler <span style=color:#f92672>=</span> StandardScaler()
</span></span><span style=display:flex><span>normalizedDF <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>DataFrame(scaler<span style=color:#f92672>.</span>fit_transform(res_data01), columns<span style=color:#f92672>=</span>res_data01<span style=color:#f92672>.</span>columns)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 進行 K-means 聚類，使用 4 個群</span>
</span></span><span style=display:flex><span>kmeans <span style=color:#f92672>=</span> KMeans(n_clusters<span style=color:#f92672>=</span><span style=color:#ae81ff>4</span>, random_state<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>kmeans<span style=color:#f92672>.</span>fit(normalizedDF)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 聚類中心</span>
</span></span><span style=display:flex><span>print(kmeans<span style=color:#f92672>.</span>cluster_centers_)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 加入群集標籤到原始資料中</span>
</span></span><span style=display:flex><span>df1[<span style=color:#e6db74>&#39;Cluster&#39;</span>] <span style=color:#f92672>=</span> kmeans<span style=color:#f92672>.</span>labels_
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 每個群集的數量統計</span>
</span></span><span style=display:flex><span>print(df1<span style=color:#f92672>.</span>groupby(<span style=color:#e6db74>&#39;Cluster&#39;</span>)<span style=color:#f92672>.</span>size())
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 群集 1 中的客戶統計</span>
</span></span><span style=display:flex><span>print(df1[df1[<span style=color:#e6db74>&#39;Cluster&#39;</span>] <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span>]<span style=color:#f92672>.</span>groupby(<span style=color:#e6db74>&#39;CustomerID&#39;</span>)<span style=color:#f92672>.</span>size())
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 計算不同群數的輪廓係數 (Silhouette Score)</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> n_cluster <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>9</span>):
</span></span><span style=display:flex><span>    kmeans <span style=color:#f92672>=</span> KMeans(n_clusters<span style=color:#f92672>=</span>n_cluster, random_state<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>    cluster_labels <span style=color:#f92672>=</span> kmeans<span style=color:#f92672>.</span>fit_predict(normalizedDF[[<span style=color:#e6db74>&#39;TotalSales&#39;</span>, <span style=color:#e6db74>&#39;OrderCount&#39;</span>, <span style=color:#e6db74>&#39;AvgOrderValue&#39;</span>]])
</span></span><span style=display:flex><span>    silhouette_avg <span style=color:#f92672>=</span> silhouette_score(normalizedDF[[<span style=color:#e6db74>&#39;TotalSales&#39;</span>, <span style=color:#e6db74>&#39;OrderCount&#39;</span>, <span style=color:#e6db74>&#39;AvgOrderValue&#39;</span>]], cluster_labels)
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;Silhouette Score for </span><span style=color:#e6db74>{</span>n_cluster<span style=color:#e6db74>}</span><span style=color:#e6db74> Clusters: </span><span style=color:#e6db74>{</span>silhouette_avg<span style=color:#e6db74>:</span><span style=color:#e6db74>.4f</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;</span>)
</span></span></code></pre></div><div class=embed-pdf-container id=embed-pdf-container-64c63578><div class=pdf-loadingWrapper id=pdf-loadingWrapper-64c63578><div class=pdf-loading id=pdf-loading-64c63578></div></div><div id=overlayText><a href=/files/US_Cities.pdf aria-label=Download download><svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18"><path d="M9 13c.3.0.5-.1.7-.3L15.4 7 14 5.6l-4 4V1H8v8.6l-4-4L2.6 7l5.7 5.7c.2.2.4.3.7.3zm-7 2h14v2H2z"/></svg></a></div><canvas class=pdf-canvas id=pdf-canvas-64c63578></canvas></div><div class=pdf-paginator id=pdf-paginator-64c63578><button id=pdf-prev-64c63578>上一頁 </button>&nbsp;&nbsp;
<button id=pdf-next-64c63578>下一頁 </button> &nbsp; &nbsp;
<span><span class=pdf-pagenum id=pdf-pagenum-64c63578></span> / <span class=pdf-pagecount id=pdf-pagecount-64c63578></span>
</span>&nbsp;
<a class=pdf-source id=pdf-source-64c63578 href=/files/US_Cities.pdf>[ 檢視PDF全文 ]</a></div><noscript>View the PDF file <a class=pdf-source id=pdf-source-noscript-64c63578 href=/files/US_Cities.pdf>here</a>.</noscript><script type=text/javascript>(function(){c="/files/US_Cities.pdf",u=""==="true",l=""==="true",h=parseInt("")||1,s=window["pdfjs-dist/build/pdf"],s.GlobalWorkerOptions.workerSrc==""&&(s.GlobalWorkerOptions.workerSrc="https://aimv.sidrlab.net/js/pdf-js/build/pdf.worker.js");var s,c,l,u,h,n=null,e=h,i=!1,o=null,b=3,t=document.getElementById("pdf-canvas-64c63578"),m=t.getContext("2d"),f=document.getElementById("pdf-paginator-64c63578"),r=document.getElementById("pdf-loadingWrapper-64c63578");v(),g();function a(e){i=!0,n.getPage(e).then(function(e){var s,r,n=e.getViewport({scale:b});t.height=n.height,t.width=n.width,s={canvasContext:m,viewport:n},r=e.render(s),r.promise.then(function(){i=!1,p(),o!==null&&(a(o),o=null)})}),document.getElementById("pdf-pagenum-64c63578").textContent=e}function p(){r.style.display="none",t.style.display="block"}function g(){if(l)return;r.style.display="flex",t.style.display="none"}function v(){if(u)return;f.style.display="block"}function d(e){i?o=e:a(e)}function j(){if(e<=1)return;e--,d(e)}document.getElementById("pdf-prev-64c63578").addEventListener("click",j);function y(){if(e>=n.numPages)return;e++,d(e)}document.getElementById("pdf-next-64c63578").addEventListener("click",y),s.getDocument(c).promise.then(function(t){n=t;var s=n.numPages;document.getElementById("pdf-pagecount-64c63578").textContent=s,e>s&&(e=s),a(e)})})()</script><hr><h2 id=20240508-association-rule-關聯法則-啤酒與尿布>20240508 Association Rule (關聯法則 啤酒與尿布)</h2><p>指令一：</p><p>請你記住以下四個構面和定義，以協助後面歸納，分別是：</p><ol><li>Experience：遊客在旅行中所感受到的一切，這個詞能夠綜合表達旅行帶來的各種感受和體驗，以及對這些體驗的總體評價。</li><li>Fulfillment：遊客對旅行的意義和滿足感，反映他們是否認為旅行有意義，以及是否從中獲得了個人滿足感。</li><li>Discovery：在旅行中遊客所獲得的新發現和學習，包括對自己的認識、新獲取的信息以及對新體驗的興奮感。</li><li>Unique：旅程中的獨特性，表明旅行是一次千載難逢的體驗，或者是一次能夠近距離體驗當地文化的機會。</li></ol><p>再來，我有四個規則要請你遵守：</p><ol><li>歸納的時候，請幫我依據詞意的「相近性」進行分類
2.一個字只會被歸類到一個類別中。
3.只能出現我有給你的字，請勿加入其他在網路上搜到的字。</li></ol><p>請根據上述規則，把下列的字詞進行歸納</p><p>指令二（接續指令一的結果）：</p><p>構面Experience的定義為：遊客在旅行中所感受到的一切，這個詞能夠綜合表達旅行帶來的各種感受和體驗，以及對這些體驗的總體評價。
請從下列187個單字中（指令一歸納在Experience的字詞），擷取出20個最適合用來衡量這個構面的單詞：</p><p>構面Fulfillment的定義為：遊客對旅行的意義和滿足感，反映他們是否認為旅行有意義，以及是否從中獲得了個人滿足感。 請從下列22個單字中（指令一歸納在Fulfillment的字詞），萃取出20個最適合用來衡量這個構面的單詞：</p><p>構面Discovery的定義為：在旅行中遊客所獲得的新發現和學習，包括對自己的認識、新獲取的信息以及對新體驗的興奮感。 請從下列103個單字中（指令一歸納在Discovery的字詞），萃取出20個最適合用來衡量這個構面的單詞：</p><p>構面Unique的定義為：旅程中的獨特性，表明旅行是一次千載難逢的體驗，或者是一次能夠近距離體驗當地文化的機會。 請從下列164個單字中（指令一歸納在Unique的字詞），萃取出20個最適合用來衡量這個構面的單詞：</p><p>Raddit Traveling to Taiwan Posts</p><p>Prompt 1.</p><p>Assumed you are a academic researhcer,
based on the definition of Experience,
Fulfillment, Discovery, and Uniquie as the following:</p><p>(1) Experience
It refers to travelers&rsquo; mindset and
experiences of seeking joy and happiness during their journey. This dimension
highlights travelers&rsquo; emphasis on the diversity of experiences and exploration
while pursuing pleasure and enjoyment, as well as the positive emotions and
satisfaction gained during the journey.&rdquo;</p><p>(2)Fulfillment
It refers to the degree to which travelers
find profound meaning in the overall journey, reflecting a desire to seek
spiritual fulfillment and personal growth during the trip. This dimension
encompasses travelers&rsquo; pursuit of pleasure and novelty while also focusing on
the deeper significance of travel, such as respect for culture, engagement in
meaningful activities, and the pursuit of personal development.</p><p>(3)Discovery
It refers to the various knowledge and
information gained by travelers during the journey. This dimension highlights
the importance travelers place on seeking knowledge and learning during their
travels, viewing travel as a pathway to enriching life experiences.</p><p>(4)Unique
It refers to the sense of novelty that
travelers seek, experience, and cherish during their journey. This dimension
emphasizes travelers&rsquo; pursuit of diverse, unique, and captivating experiences,
as well as the pleasure and fulfillment derived from these experiences.</p><p>Could you categorize the following sentences, I will give you later,
from consumer reviews based on the definition of dimensions above of Experience,
Fulfillment, Discovery, and Unique.</p><p>2.Assumed you are a academic researcher, based on the definition of Experience, Fulfillment, Discovery, and Uniquie as the following:</p><p>(1) Experience
It refers to travelers&rsquo; mindset and experiences of seeking joy and happiness during their journey. This dimension highlights travelers&rsquo; emphasis on the diversity of experiences and exploration while pursuing pleasure and enjoyment, as well as the positive emotions and satisfaction gained during the journey."</p><p>(2)Fulfillment
It refers to the degree to which travelers find profound meaning in the overall journey, reflecting a desire to seek spiritual fulfillment and personal growth during the trip. This dimension encompasses travelers&rsquo; pursuit of pleasure and novelty while also focusing on the deeper significance of travel, such as respect for culture, engagement in meaningful activities, and the pursuit of personal development.</p><p>(3)Discovery
It refers to the various knowledge and information gained by travelers during the journey. This dimension highlights the importance travelers place on seeking knowledge and learning during their travels, viewing travel as a pathway to enriching life experiences.</p><p>(4)Unique
It refers to the sense of novelty that travelers seek, experience, and cherish during their journey. This dimension emphasizes travelers&rsquo; pursuit of diverse, unique, and captivating experiences, as well as the pleasure and fulfillment derived from these experiences.</p><p>Could you extract keywords from the following sentences of consumer reviews , I will give you later, based on the definition of dimensions above of Experience, Fulfillment, Discovery, and Unique.</p><h3 id=關聯法則-r語言程式碼>關聯法則 R語言程式碼</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-R data-lang=R><span style=display:flex><span><span style=color:#75715e># 關聯法則 R語言程式碼</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Installing Packages </span>
</span></span><span style=display:flex><span><span style=color:#75715e># Loading package </span>
</span></span><span style=display:flex><span><span style=color:#75715e>#Sys.setenv(JAVA_HOME=&#39;C:\\Program Files\\Java\\jre1.8.0_291&#39;) </span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(arules) 
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(arulesViz) 
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(xlsx)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>setwd</span>(<span style=color:#e6db74>&#34;c:/Koong/csv/DataScience&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>beeRread.xlsx</span>(<span style=color:#e6db74>&#34;beerAR.xlsx&#34;</span>,headeRTRUE,sheetIndex<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>dataset<span style=color:#f92672>=</span><span style=color:#a6e22e>as.matrix</span>(beer)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Structure  </span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>str</span>(dataset) 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>set.seed <span style=color:#f92672>=</span> <span style=color:#ae81ff>220</span> <span style=color:#75715e># Setting seed </span>
</span></span><span style=display:flex><span>associa_rules <span style=color:#f92672>=</span> <span style=color:#a6e22e>apriori</span>(data <span style=color:#f92672>=</span> dataset,  
</span></span><span style=display:flex><span>                        parameter <span style=color:#f92672>=</span> <span style=color:#a6e22e>list</span>(support <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.3</span>,  
</span></span><span style=display:flex><span>                                         confidence <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.5</span>)) 
</span></span><span style=display:flex><span><span style=color:#75715e>#--------------------------------------------------------</span>
</span></span><span style=display:flex><span>rules <span style=color:#f92672>&lt;-</span> associa_rules<span style=color:#a6e22e>[size</span>(<span style=color:#a6e22e>lhs</span>(associa_rules)) <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span><span style=color:#75715e>#--------------------------------------------------------</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Plot </span>
</span></span><span style=display:flex><span><span style=color:#75715e>#itemFrequencyPlot(dataset, topN = 5) </span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Visualising the results </span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>inspect</span>(<span style=color:#a6e22e>sort</span>(rules, by <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;confidence&#39;</span>)) 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>plot</span>(rules, method <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;graph&#34;</span>,  
</span></span><span style=display:flex><span>     measure <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;confidence&#34;</span>, shading <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;lift&#34;</span>) 
</span></span></code></pre></div><h3 id=關聯法則-python程式碼請自行確認是否能運作>關聯法則 Python程式碼(請自行確認是否能運作)</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># 匯入所需的函式庫</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> pandas <span style=color:#66d9ef>as</span> pd
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> mlxtend.frequent_patterns <span style=color:#f92672>import</span> apriori, association_rules
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> matplotlib.pyplot <span style=color:#66d9ef>as</span> plt
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> openpyxl <span style=color:#f92672>import</span> load_workbook
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 設定工作目錄</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span>os<span style=color:#f92672>.</span>chdir(<span style=color:#e6db74>&#34;c:/Koong/csv/DataScience&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 讀取 Excel 檔案</span>
</span></span><span style=display:flex><span>beer <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>read_excel(<span style=color:#e6db74>&#34;beerAR.xlsx&#34;</span>, sheet_name<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 查看資料結構</span>
</span></span><span style=display:flex><span>print(beer<span style=color:#f92672>.</span>head())
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 設定隨機種子</span>
</span></span><span style=display:flex><span>np<span style=color:#f92672>.</span>random<span style=color:#f92672>.</span>seed(<span style=color:#ae81ff>220</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 使用 apriori 算法進行關聯規則挖掘</span>
</span></span><span style=display:flex><span>frequent_itemsets <span style=color:#f92672>=</span> apriori(beer, min_support<span style=color:#f92672>=</span><span style=color:#ae81ff>0.3</span>, use_colnames<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 計算關聯規則</span>
</span></span><span style=display:flex><span>rules <span style=color:#f92672>=</span> association_rules(frequent_itemsets, metric<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;confidence&#34;</span>, min_threshold<span style=color:#f92672>=</span><span style=color:#ae81ff>0.5</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 過濾規則，僅保留左手邊 (lhs) 非空的規則</span>
</span></span><span style=display:flex><span>rules <span style=color:#f92672>=</span> rules[rules[<span style=color:#e6db74>&#39;antecedents&#39;</span>]<span style=color:#f92672>.</span>apply(<span style=color:#66d9ef>lambda</span> x: len(x) <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>)]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 依據信心度排序並顯示規則</span>
</span></span><span style=display:flex><span>sorted_rules <span style=color:#f92672>=</span> rules<span style=color:#f92672>.</span>sort_values(by<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;confidence&#39;</span>, ascending<span style=color:#f92672>=</span><span style=color:#66d9ef>False</span>)
</span></span><span style=display:flex><span>print(sorted_rules)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 繪製規則</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> networkx <span style=color:#66d9ef>as</span> nx
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> matplotlib.pyplot <span style=color:#66d9ef>as</span> plt
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>plot_association_rules</span>(rules):
</span></span><span style=display:flex><span>    G <span style=color:#f92672>=</span> nx<span style=color:#f92672>.</span>DiGraph()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> _, rule <span style=color:#f92672>in</span> rules<span style=color:#f92672>.</span>iterrows():
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> antecedent <span style=color:#f92672>in</span> rule[<span style=color:#e6db74>&#39;antecedents&#39;</span>]:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> consequent <span style=color:#f92672>in</span> rule[<span style=color:#e6db74>&#39;consequents&#39;</span>]:
</span></span><span style=display:flex><span>                G<span style=color:#f92672>.</span>add_edge(antecedent, consequent, weight<span style=color:#f92672>=</span>rule[<span style=color:#e6db74>&#39;confidence&#39;</span>])
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>    pos <span style=color:#f92672>=</span> nx<span style=color:#f92672>.</span>spring_layout(G)
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>figure(figsize<span style=color:#f92672>=</span>(<span style=color:#ae81ff>12</span>, <span style=color:#ae81ff>8</span>))
</span></span><span style=display:flex><span>    nx<span style=color:#f92672>.</span>draw(G, pos, with_labels<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>, node_size<span style=color:#f92672>=</span><span style=color:#ae81ff>3000</span>, node_coloR<span style=color:#e6db74>&#34;skyblue&#34;</span>, font_size<span style=color:#f92672>=</span><span style=color:#ae81ff>10</span>, font_coloR<span style=color:#e6db74>&#34;black&#34;</span>, font_weight<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;bold&#34;</span>, edge_coloR<span style=color:#e6db74>&#34;grey&#34;</span>)
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>title(<span style=color:#e6db74>&#34;Association Rules Graph&#34;</span>)
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>show()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>plot_association_rules(sorted_rules)
</span></span></code></pre></div><div class=embed-pdf-container id=embed-pdf-container-1c0581f9><div class=pdf-loadingWrapper id=pdf-loadingWrapper-1c0581f9><div class=pdf-loading id=pdf-loading-1c0581f9></div></div><div id=overlayText><a href=/files/association_rule.pdf aria-label=Download download><svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18"><path d="M9 13c.3.0.5-.1.7-.3L15.4 7 14 5.6l-4 4V1H8v8.6l-4-4L2.6 7l5.7 5.7c.2.2.4.3.7.3zm-7 2h14v2H2z"/></svg></a></div><canvas class=pdf-canvas id=pdf-canvas-1c0581f9></canvas></div><div class=pdf-paginator id=pdf-paginator-1c0581f9><button id=pdf-prev-1c0581f9>上一頁 </button>&nbsp;&nbsp;
<button id=pdf-next-1c0581f9>下一頁 </button> &nbsp; &nbsp;
<span><span class=pdf-pagenum id=pdf-pagenum-1c0581f9></span> / <span class=pdf-pagecount id=pdf-pagecount-1c0581f9></span>
</span>&nbsp;
<a class=pdf-source id=pdf-source-1c0581f9 href=/files/association_rule.pdf>[ 檢視PDF全文 ]</a></div><noscript>View the PDF file <a class=pdf-source id=pdf-source-noscript-1c0581f9 href=/files/association_rule.pdf>here</a>.</noscript><script type=text/javascript>(function(){c="/files/association_rule.pdf",u=""==="true",l=""==="true",h=parseInt("")||1,s=window["pdfjs-dist/build/pdf"],s.GlobalWorkerOptions.workerSrc==""&&(s.GlobalWorkerOptions.workerSrc="https://aimv.sidrlab.net/js/pdf-js/build/pdf.worker.js");var s,c,l,u,h,n=null,e=h,i=!1,o=null,b=3,t=document.getElementById("pdf-canvas-1c0581f9"),m=t.getContext("2d"),f=document.getElementById("pdf-paginator-1c0581f9"),r=document.getElementById("pdf-loadingWrapper-1c0581f9");v(),g();function a(e){i=!0,n.getPage(e).then(function(e){var s,r,n=e.getViewport({scale:b});t.height=n.height,t.width=n.width,s={canvasContext:m,viewport:n},r=e.render(s),r.promise.then(function(){i=!1,p(),o!==null&&(a(o),o=null)})}),document.getElementById("pdf-pagenum-1c0581f9").textContent=e}function p(){r.style.display="none",t.style.display="block"}function g(){if(l)return;r.style.display="flex",t.style.display="none"}function v(){if(u)return;f.style.display="block"}function d(e){i?o=e:a(e)}function j(){if(e<=1)return;e--,d(e)}document.getElementById("pdf-prev-1c0581f9").addEventListener("click",j);function y(){if(e>=n.numPages)return;e++,d(e)}document.getElementById("pdf-next-1c0581f9").addEventListener("click",y),s.getDocument(c).promise.then(function(t){n=t;var s=n.numPages;document.getElementById("pdf-pagecount-1c0581f9").textContent=s,e>s&&(e=s),a(e)})})()</script><hr><h2 id=20240511-decision-tree>20240511 Decision Tree</h2><p>Azure Machine Learning Studio (<a href=https://studio.azureml.net target=_blank>https://studio.azureml.net</a>
) (大數據分析_2023.pptx)
CsutomerLifetimeValue DataSet (CustomerValueClean.csv)</p><h3 id=decision-tree-r語言程式碼>Decision Tree R語言程式碼</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-R data-lang=R><span style=display:flex><span><span style=color:#a6e22e>library</span>(C50)
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(gmodels)
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(party)
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(RColorBrewer)
</span></span><span style=display:flex><span><span style=color:#a6e22e>require</span>(caret)
</span></span><span style=display:flex><span><span style=color:#a6e22e>require</span>(e1071)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>setwd</span>(<span style=color:#e6db74>&#34;c://Koong//csv//DataScience//DSMK&#34;</span>)
</span></span><span style=display:flex><span>credit <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>read.csv</span>(<span style=color:#e6db74>&#34;CustomerValueClean.csv&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#75715e>#============== 產生 訓練資料及測試資料集 =================</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Create the training and test datasets</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>set.seed</span>(<span style=color:#ae81ff>100</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Step 1: Get row numbers for the training data</span>
</span></span><span style=display:flex><span>trainRowNumbers <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>createDataPartition</span>(credit<span style=color:#f92672>$</span>Response, p<span style=color:#f92672>=</span><span style=color:#ae81ff>0.7</span>, list<span style=color:#f92672>=</span><span style=color:#66d9ef>FALSE</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Step 2: Create the training  dataset</span>
</span></span><span style=display:flex><span>trainData <span style=color:#f92672>&lt;-</span> credit[trainRowNumbers,]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Step 3: Create the test dataset</span>
</span></span><span style=display:flex><span>testData <span style=color:#f92672>&lt;-</span> credit[<span style=color:#f92672>-</span>trainRowNumbers,]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Store X (自變數) and Y (依變數)for later use.</span>
</span></span><span style=display:flex><span>x <span style=color:#f92672>=</span> trainData[, <span style=color:#ae81ff>-3</span>]
</span></span><span style=display:flex><span>y <span style=color:#f92672>=</span> trainData<span style=color:#f92672>$</span>Response
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#--------------------------------------------------------------------</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#我們避免模型過度擬合(overfitting)，故要利用K-fold Cross-Validation#</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#的方法進行交叉驗證，我們使用caret這個套件，而K先設定為10次~</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#---------------------------------- rpart  + CARET ----------------</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>modelLookup</span>(<span style=color:#e6db74>&#34;rpart&#34;</span>)
</span></span><span style=display:flex><span>train_control <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>trainControl</span>(method<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;cv&#34;</span>, numbeR3)
</span></span><span style=display:flex><span>train_control.model <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>train</span>(Response<span style=color:#f92672>~</span>., 
</span></span><span style=display:flex><span>                             data<span style=color:#f92672>=</span>trainData, 
</span></span><span style=display:flex><span>                             method<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;rpart&#34;</span>,
</span></span><span style=display:flex><span>                             trControl<span style=color:#f92672>=</span>train_control,
</span></span><span style=display:flex><span>                             tuneLength <span style=color:#f92672>=</span> <span style=color:#ae81ff>6</span>)
</span></span><span style=display:flex><span>train_control.model
</span></span><span style=display:flex><span><span style=color:#75715e>#---------   Prediction  ---------------------------------</span>
</span></span><span style=display:flex><span>pred <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>predict</span>(train_control.model, newdata<span style=color:#f92672>=</span>testData)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 用table看預測的情況</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>table</span>(real<span style=color:#f92672>=</span>testData<span style=color:#f92672>$</span>Response, predict<span style=color:#f92672>=</span>pred)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 計算預測準確率 = 對角線的數量/總數量</span>
</span></span><span style=display:flex><span>confus.matrix <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>table</span>(real<span style=color:#f92672>=</span>testData<span style=color:#f92672>$</span>Response, predict<span style=color:#f92672>=</span>pred)
</span></span><span style=display:flex><span><span style=color:#a6e22e>sum</span>(<span style=color:#a6e22e>diag</span>(confus.matrix))<span style=color:#f92672>/</span><span style=color:#a6e22e>sum</span>(confus.matrix) <span style=color:#75715e># 對角線的數量/總數量</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(rattle)
</span></span><span style=display:flex><span><span style=color:#a6e22e>fancyRpartPlot</span>(train_control.model<span style=color:#f92672>$</span>finalModel)
</span></span><span style=display:flex><span><span style=color:#75715e>#---------------------------- Advance CARET -------------------</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#names(getModelInfo())</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#modelLookup(&#34;ctree2&#34;)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#---------------------------------- ctree2 + CARET ----------------</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>library</span>(party)
</span></span><span style=display:flex><span><span style=color:#a6e22e>set.seed</span>(<span style=color:#ae81ff>123</span>)
</span></span><span style=display:flex><span>train_control.model <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>train</span>(
</span></span><span style=display:flex><span>  Response<span style=color:#f92672>~</span>., data <span style=color:#f92672>=</span> trainData, method <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;ctree2&#34;</span>,
</span></span><span style=display:flex><span>  trControl <span style=color:#f92672>=</span> <span style=color:#a6e22e>trainControl</span>(<span style=color:#e6db74>&#34;cv&#34;</span>, number <span style=color:#f92672>=</span> <span style=color:#ae81ff>5</span>),
</span></span><span style=display:flex><span>  tuneGrid <span style=color:#f92672>=</span> <span style=color:#a6e22e>expand.grid</span>(maxdepth <span style=color:#f92672>=</span><span style=color:#ae81ff>3</span>, mincriterion <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.95</span> )
</span></span><span style=display:flex><span>  <span style=color:#75715e>#tuneLength = 6, </span>
</span></span><span style=display:flex><span>  )
</span></span><span style=display:flex><span><span style=color:#a6e22e>plot</span>(train_control.model<span style=color:#f92672>$</span>finalModel)
</span></span><span style=display:flex><span><span style=color:#75715e>#---------   Prediction  ---------------------------------</span>
</span></span><span style=display:flex><span>pred <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>predict</span>(train_control.model, newdata<span style=color:#f92672>=</span>testData)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 用table看預測的情況</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>table</span>(real<span style=color:#f92672>=</span>testData<span style=color:#f92672>$</span>Response, predict<span style=color:#f92672>=</span>pred)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 計算預測準確率 = 對角線的數量/總數量</span>
</span></span><span style=display:flex><span>confus.matrix <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>table</span>(real<span style=color:#f92672>=</span>testData<span style=color:#f92672>$</span>Response, predict<span style=color:#f92672>=</span>pred)
</span></span><span style=display:flex><span><span style=color:#a6e22e>sum</span>(<span style=color:#a6e22e>diag</span>(confus.matrix))<span style=color:#f92672>/</span><span style=color:#a6e22e>sum</span>(confus.matrix) <span style=color:#75715e># 對角線的數量/總數量</span>
</span></span></code></pre></div><h3 id=decision-tree-python程式碼請自行確認是否能運作>Decision Tree Python程式碼(請自行確認是否能運作)</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># 匯入所需的函式庫</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> pandas <span style=color:#66d9ef>as</span> pd
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> numpy <span style=color:#66d9ef>as</span> np
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> sklearn.model_selection <span style=color:#f92672>import</span> train_test_split, cross_val_score, GridSearchCV
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> sklearn.tree <span style=color:#f92672>import</span> DecisionTreeClassifier
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> sklearn.metrics <span style=color:#f92672>import</span> confusion_matrix, accuracy_score
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> sklearn.ensemble <span style=color:#f92672>import</span> RandomForestClassifier
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> matplotlib.pyplot <span style=color:#66d9ef>as</span> plt
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> seaborn <span style=color:#66d9ef>as</span> sns
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> graphviz
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> sklearn.tree <span style=color:#f92672>import</span> export_graphviz
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> sklearn.tree <span style=color:#f92672>import</span> plot_tree
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 設定工作目錄</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span>os<span style=color:#f92672>.</span>chdir(<span style=color:#e6db74>&#34;c://Koong//csv//DataScience//DSMK&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 讀取 csv 檔案</span>
</span></span><span style=display:flex><span>credit <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>read_csv(<span style=color:#e6db74>&#34;CustomerValueClean.csv&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 設定隨機種子</span>
</span></span><span style=display:flex><span>np<span style=color:#f92672>.</span>random<span style=color:#f92672>.</span>seed(<span style=color:#ae81ff>100</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 分割訓練資料與測試資料</span>
</span></span><span style=display:flex><span>trainData, testData <span style=color:#f92672>=</span> train_test_split(credit, test_size<span style=color:#f92672>=</span><span style=color:#ae81ff>0.3</span>, stratify<span style=color:#f92672>=</span>credit[<span style=color:#e6db74>&#39;Response&#39;</span>], random_state<span style=color:#f92672>=</span><span style=color:#ae81ff>100</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 提取自變數 (X) 和依變數 (y)</span>
</span></span><span style=display:flex><span>X_train <span style=color:#f92672>=</span> trainData<span style=color:#f92672>.</span>drop(columns<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#39;Response&#39;</span>])
</span></span><span style=display:flex><span>y_train <span style=color:#f92672>=</span> trainData[<span style=color:#e6db74>&#39;Response&#39;</span>]
</span></span><span style=display:flex><span>X_test <span style=color:#f92672>=</span> testData<span style=color:#f92672>.</span>drop(columns<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#39;Response&#39;</span>])
</span></span><span style=display:flex><span>y_test <span style=color:#f92672>=</span> testData[<span style=color:#e6db74>&#39;Response&#39;</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 使用 K-fold 交叉驗證方法避免過度擬合 (overfitting)</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 使用決策樹進行分類</span>
</span></span><span style=display:flex><span>dt_model <span style=color:#f92672>=</span> DecisionTreeClassifier(random_state<span style=color:#f92672>=</span><span style=color:#ae81ff>100</span>)
</span></span><span style=display:flex><span>param_grid <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#39;max_depth&#39;</span>: range(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>10</span>), <span style=color:#e6db74>&#39;min_samples_split&#39;</span>: range(<span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>10</span>)}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 設置交叉驗證</span>
</span></span><span style=display:flex><span>cv <span style=color:#f92672>=</span> GridSearchCV(dt_model, param_grid, cv<span style=color:#f92672>=</span><span style=color:#ae81ff>3</span>)
</span></span><span style=display:flex><span>cv<span style=color:#f92672>.</span>fit(X_train, y_train)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 最佳模型</span>
</span></span><span style=display:flex><span>best_model <span style=color:#f92672>=</span> cv<span style=color:#f92672>.</span>best_estimator_
</span></span><span style=display:flex><span>print(best_model)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 預測</span>
</span></span><span style=display:flex><span>y_pred <span style=color:#f92672>=</span> best_model<span style=color:#f92672>.</span>predict(X_test)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 用混淆矩陣查看預測結果</span>
</span></span><span style=display:flex><span>conf_matrix <span style=color:#f92672>=</span> confusion_matrix(y_test, y_pred)
</span></span><span style=display:flex><span>print(conf_matrix)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 計算準確率</span>
</span></span><span style=display:flex><span>accuracy <span style=color:#f92672>=</span> accuracy_score(y_test, y_pred)
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Accuracy: </span><span style=color:#e6db74>{</span>accuracy<span style=color:#e6db74>:</span><span style=color:#e6db74>.4f</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 繪製決策樹</span>
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>figure(figsize<span style=color:#f92672>=</span>(<span style=color:#ae81ff>20</span>,<span style=color:#ae81ff>10</span>))
</span></span><span style=display:flex><span>plot_tree(best_model, feature_names<span style=color:#f92672>=</span>X_train<span style=color:#f92672>.</span>columns, class_names<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#39;0&#39;</span>, <span style=color:#e6db74>&#39;1&#39;</span>], filled<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>)
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>show()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 使用更進階的決策樹模型 (ctree2)</span>
</span></span><span style=display:flex><span>rf_model <span style=color:#f92672>=</span> RandomForestClassifier(random_state<span style=color:#f92672>=</span><span style=color:#ae81ff>123</span>, max_depth<span style=color:#f92672>=</span><span style=color:#ae81ff>3</span>, min_samples_split<span style=color:#f92672>=</span><span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>rf_model<span style=color:#f92672>.</span>fit(X_train, y_train)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 預測</span>
</span></span><span style=display:flex><span>y_pred_rf <span style=color:#f92672>=</span> rf_model<span style=color:#f92672>.</span>predict(X_test)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 用混淆矩陣查看預測結果</span>
</span></span><span style=display:flex><span>conf_matrix_rf <span style=color:#f92672>=</span> confusion_matrix(y_test, y_pred_rf)
</span></span><span style=display:flex><span>print(conf_matrix_rf)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 計算準確率</span>
</span></span><span style=display:flex><span>accuracy_rf <span style=color:#f92672>=</span> accuracy_score(y_test, y_pred_rf)
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;Accuracy (Random Forest): </span><span style=color:#e6db74>{</span>accuracy_rf<span style=color:#e6db74>:</span><span style=color:#e6db74>.4f</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span></code></pre></div><hr><h2 id=20240605-seo>20240605 SEO</h2><p>流量學SEO(06/05)
SEO搜尋引擎最佳化
0.Google Search Engin 個案討論
1.SEO搜尋引擎最佳化實務驟
2.SEO 關鍵字工作表
4.目標關鍵字</p></div><div class="row items-start justify-between"><div class="lg:col-5 mb-10 flex items-center lg:mb-0"><h5 class=mr-3>Tags:</h5><ul><li class=inline-block><a class="bg-theme-light hover:bg-primary dark:bg-darkmode-theme-light dark:hover:bg-darkmode-primary dark:hover:text-dark m-1 block rounded px-3 py-1 hover:text-white" href=/tags/application/>Application</a></li><li class=inline-block><a class="bg-theme-light hover:bg-primary dark:bg-darkmode-theme-light dark:hover:bg-darkmode-primary dark:hover:text-dark m-1 block rounded px-3 py-1 hover:text-white" href=/tags/dataanalytics/>Data analytics</a></li><li class=inline-block><a class="bg-theme-light hover:bg-primary dark:bg-darkmode-theme-light dark:hover:bg-darkmode-primary dark:hover:text-dark m-1 block rounded px-3 py-1 hover:text-white" href=/tags/2024/>2024th</a></li></ul></div><div class="lg:col-4 flex items-center"><div class=share-icons><h5 class=share-title>Share :</h5><a class="share-link share-facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2faimv.sidrlab.net%2fblog%2f2024%2fmarketing_ds%2f" target=_blank rel=noopener aria-label="share facebook"><span class=share-icon><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18.77 7.46H14.5v-1.9c0-.9.6-1.1 1-1.1h3V.5h-4.33C10.24.5 9.5 3.44 9.5 5.32v2.15h-3v4h3v12h5v-12h3.85l.42-4z"/></svg>
</span></a><a class="share-link share-twitter" href="https://twitter.com/intent/tweet/?text=Share&amp;url=https%3a%2f%2faimv.sidrlab.net%2fblog%2f2024%2fmarketing_ds%2f" target=_blank rel=noopener aria-label="share twitter"><span aria-hidden=true class=share-icon><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8 2H1l8.26 11.015L1.45 22H4.1l6.388-7.349L16 22h7l-8.608-11.478L21.8 2h-2.65l-5.986 6.886zm9 18L5 4h2l12 16z"/></svg>
</span></a><a class="share-link share-email" href="mailto:?subject=Share&amp;body=https%3a%2f%2faimv.sidrlab.net%2fblog%2f2024%2fmarketing_ds%2f" target=_self rel=noopener aria-label="share email"><span aria-hidden=true class=share-icon><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M22 4H2C.9 4 0 4.9.0 6v12c0 1.1.9 2 2 2h20c1.1.0 2-.9 2-2V6c0-1.1-.9-2-2-2zM7.25 14.43l-3.5 2c-.08.05-.17.07-.25.07-.17.0-.34-.1-.43-.25-.14-.24-.06-.55.18-.68l3.5-2c.24-.14.55-.06.68.18.14.24.06.55-.18.68zm4.75.07c-.1.0-.2-.03-.27-.08l-8.5-5.5c-.23-.15-.3-.46-.15-.7.15-.22.46-.3.7-.14L12 13.4l8.23-5.32c.23-.15.54-.08.7.15.14.23.07.54-.16.7l-8.5 5.5c-.08.04-.17.07-.27.07zm8.93 1.75c-.1.16-.26.25-.43.25-.08.0-.17-.02-.25-.07l-3.5-2c-.24-.13-.32-.44-.18-.68s.44-.32.68-.18l3.5 2c.24.13.32.44.18.68z"/></svg>
</span></a><a class="share-link share-reddit" href="https://reddit.com/submit/?url=https%3a%2f%2faimv.sidrlab.net%2fblog%2f2024%2fmarketing_ds%2f&amp;resubmit=true&amp;title=Share" target=_blank rel=noopener aria-label="share reddit"><span aria-hidden=true class=share-icon><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M24 11.5c0-1.65-1.35-3-3-3-.96.0-1.86.48-2.42 1.24-1.64-1-3.75-1.64-6.07-1.72.08-1.1.4-3.05 1.52-3.7.72-.4 1.73-.24 3 .5C17.2 6.3 18.46 7.5 20 7.5c1.65.0 3-1.35 3-3s-1.35-3-3-3c-1.38.0-2.54.94-2.88 2.22-1.43-.72-2.64-.8-3.6-.25-1.64.94-1.95 3.47-2 4.55-2.33.08-4.45.7-6.1 1.72C4.86 8.98 3.96 8.5 3 8.5c-1.65.0-3 1.35-3 3 0 1.32.84 2.44 2.05 2.84-.03.22-.05.44-.05.66.0 3.86 4.5 7 10 7s10-3.14 10-7c0-.22-.02-.44-.05-.66 1.2-.4 2.05-1.54 2.05-2.84zM2.3 13.37C1.5 13.07 1 12.35 1 11.5c0-1.1.9-2 2-2 .64.0 1.22.32 1.6.82-1.1.85-1.92 1.9-2.3 3.05zm3.7.13c0-1.1.9-2 2-2s2 .9 2 2-.9 2-2 2-2-.9-2-2zm9.8 4.8c-1.08.63-2.42.96-3.8.96-1.4.0-2.74-.34-3.8-.95-.24-.13-.32-.44-.2-.68.15-.24.46-.32.7-.18 1.83 1.06 4.76 1.06 6.6.0.23-.13.53-.05.67.2.14.23.06.54-.18.67zm.2-2.8c-1.1.0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm5.7-2.13c-.38-1.16-1.2-2.2-2.3-3.05.38-.5.97-.82 1.6-.82 1.1.0 2 .9 2 2 0 .84-.53 1.57-1.3 1.87z"/></svg></span></a></div></div></div><div class="section pb-0"><h2 class="h3 mb-12">Related Posts</h2><div class=row><div class="lg:col-4 md:col-6 mb-14"><div class="bg-body dark:bg-darkmode-body"><picture><source srcset=/images/article_picture/dataAnalytics_hubd510a47a29ee5300d2a8fbe6dddf091_571474_545x0_resize_q80_h2_lanczos.webp media="(max-width: 575px)"><source srcset=/images/article_picture/dataAnalytics_hubd510a47a29ee5300d2a8fbe6dddf091_571474_600x0_resize_q80_h2_lanczos.webp media="(max-width: 767px)"><source srcset=/images/article_picture/dataAnalytics_hubd510a47a29ee5300d2a8fbe6dddf091_571474_700x0_resize_q80_h2_lanczos.webp media="(max-width: 991px)"><source srcset=/images/article_picture/dataAnalytics_hubd510a47a29ee5300d2a8fbe6dddf091_571474_1110x0_resize_q80_h2_lanczos.webp><img loading=lazy decoding=async src=/images/article_picture/dataAnalytics_hubd510a47a29ee5300d2a8fbe6dddf091_571474_1110x0_resize_q80_lanczos.jpg class="mb-6 w-full rounded img-responsive img" alt=data_Analytics width=3000 height=2000></picture><h4 class=mb-3><a href=/blog/2024/data_analytic/>data_Analytics</a></h4><ul class=mb-4><li class="mr-4 inline-block"><a href=/authors/%E5%A7%9A%E6%85%95%E6%9D%B1/><i class="fa-regular fa-circle-user mr-2"></i>姚慕東</a></li><li class="mr-4 inline-block"><i class="fa-regular fa-folder mr-1"></i>
<a href=/categories/application/ class=ms-1>Application
,
</a><a href=/categories/dataanalytics/ class=ms-1>Data analytics</a></li></ul><p class=mb-6><p>巨量資料分析: 巨量資料分析是指用來從不同的大量高速資料集收集、處理和取得深入解析的方法、工具和應用程式<br><br></p></p><a class="btn btn-outline-primary btn-sm" href=/blog/2024/data_analytic/>Read More</a></div></div><div class="lg:col-4 md:col-6 mb-14"><div class="bg-body dark:bg-darkmode-body"><picture><source srcset=/images/article_picture/association_rule_hu8405b666fc58af13d03d3c518c02e04e_372540_545x0_resize_q80_h2_lanczos.webp media="(max-width: 575px)"><source srcset=/images/article_picture/association_rule_hu8405b666fc58af13d03d3c518c02e04e_372540_600x0_resize_q80_h2_lanczos.webp media="(max-width: 767px)"><source srcset=/images/article_picture/association_rule_hu8405b666fc58af13d03d3c518c02e04e_372540_700x0_resize_q80_h2_lanczos.webp media="(max-width: 991px)"><source srcset=/images/article_picture/association_rule_hu8405b666fc58af13d03d3c518c02e04e_372540_1110x0_resize_q80_h2_lanczos.webp><img loading=lazy decoding=async src=/images/article_picture/association_rule_hu8405b666fc58af13d03d3c518c02e04e_372540_1110x0_resize_q80_lanczos.jpg class="mb-6 w-full rounded img-responsive img" alt=association_rule width=3000 height=2000></picture><h4 class=mb-3><a href=/blog/2024/association_rule/>association_rule</a></h4><ul class=mb-4><li class="mr-4 inline-block"><a href=/authors/%E8%B6%99%E7%84%84%E4%BC%B6/><i class="fa-regular fa-circle-user mr-2"></i>趙焄伶</a></li><li class="mr-4 inline-block"><i class="fa-regular fa-folder mr-1"></i>
<a href=/categories/marketing/ class=ms-1>Marketing
,
</a><a href=/categories/dataanalytics/ class=ms-1>Data analytics</a></li></ul><p class=mb-6><p>關聯分析法則: 關聯分析法則的目標是找出大型資料集中經常共同出現的物件組合，以及這個組合中物件的關聯性。<br><br></p></p><a class="btn btn-outline-primary btn-sm" href=/blog/2024/association_rule/>Read More</a></div></div></div></div></div><button onclick=topFunction() class="btn btn-secondary" id=scrollToTopBtn title="Go to top"><i class="bi bi-arrow-bar-up"></i></button></section><style>#scrollToTopBtn{display:none;position:fixed;bottom:10px;right:20px;z-index:99;border:none;outline:none;background-color:#8b96a0;color:#fff;cursor:pointer;padding:15px;border-radius:10px;display:flex}#scrollToTopBtn:hover{background-color:#5a6268}.collapse-btn{position:absolute;top:5px;right:10px;z-index:10;background-color:#dad5d58a;color:#000;border:none;padding:5px 10px;cursor:pointer;border-radius:10px}.collapse-btn:hover{background-color:#5a6268}.table-of-content{cursor:pointer}iframe{width:90%;height:500px;margin:auto;border:10px solid #ccc}</style><script>window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?document.getElementById("scrollToTopBtn").style.display="block":document.getElementById("scrollToTopBtn").style.display="none"}function topFunction(){document.body.scrollTop=750,document.documentElement.scrollTop=750}document.addEventListener("DOMContentLoaded",function(){function t(e){var t,n=document.createElement("div");n.style.height="2em",e.parentNode.insertBefore(n,e),t=document.createElement("div"),t.style.height="2em",e.parentNode.insertBefore(t,e.nextSibling)}var e,n=document.querySelectorAll("iframe");n.forEach(t),e=document.querySelectorAll(".highlight"),e.forEach(function(e){var t,s,n=document.createElement("button");n.textContent="展開程式碼",n.className="collapse-btn",t=document.createElement("div"),t.className="code-container",t.style.position="relative",e.parentNode.insertBefore(t,e),t.appendChild(e),t.appendChild(n),s=document.createElement("div"),s.style.height="3em",t.appendChild(s),e.style.display="none",n.addEventListener("click",function(){e.style.display==="none"?(e.style.display="block",n.textContent="收折程式碼"):(e.style.display="none",n.textContent="展開程式碼")})})})</script></main><footer class="bg-theme-light dark:bg-darkmode-theme-light"><div class=container><div class="row items-center py-10"><div class="lg:col-3 mb-8 text-center lg:mb-0 lg:text-left"><a class="navbar-brand inline-block" href=/><img fetchpriority=high decoding=async class="img logo-light" width=240 height=48 src=/images/1_hu209dc01dac0d8d29161ee131376a931a_131805_480x0_resize_q80_h2_lanczos_3.webp alt=人工智慧行銷視覺實驗室 onerror='this.onerror=null,this.src="/images/1_hu209dc01dac0d8d29161ee131376a931a_131805_480x0_resize_lanczos_3.png"'>
<img fetchpriority=high decoding=async class="img logo-dark" width=240 height=48 src=/images/1_hu209dc01dac0d8d29161ee131376a931a_131805_480x0_resize_q80_h2_lanczos_3.webp alt=人工智慧行銷視覺實驗室 onerror='this.onerror=null,this.src="/images/1_hu209dc01dac0d8d29161ee131376a931a_131805_480x0_resize_lanczos_3.png"'></a></div><div class="lg:col-6 mb-8 text-center lg:mb-0"><ul><li class="m-3 inline-block"><a href=/privacy-policy/>隱私權政策</a></li><li class="m-3 inline-block"><a href=/authors/>關於我們</a></li><li class="m-3 inline-block"><a href=/contact/>聯絡我們</a></li></ul></div><div class="lg:col-3 mb-8 text-center lg:mb-0 lg:mt-0 lg:text-right"><ul class=social-icons><li><a target=_blank aria-label=facebook rel="nofollow noopener" href=https://www.facebook.com/><i class="fab fa-facebook"></i></a></li><li><a target=_blank aria-label=twitter rel="nofollow noopener" href=https://twitter.com/><i class="fab fa-twitter"></i></a></li><li><a target=_blank aria-label=github rel="nofollow noopener" href=https://www.github.com/><i class="fab fa-github"></i></a></li><li><a target=_blank aria-label=linkedin rel="nofollow noopener" href=https://www.linkedin.com/><i class="fab fa-linkedin"></i></a></li></ul></div></div></div><div class="border-border dark:border-darkmode-border border-t py-7"><div class="text-light dark:text-darkmode-light container text-center"><p>Based on <a href=https://zeon.studio target=_blank>Zeon Studio</a>
, Designed By MTYao</p></div></div></footer><script crossorigin=anonymous integrity="sha256-QyKANL8qsiU27xgAU9uCTVC7WUQCnRPb5SSdNFDofSY=" src=/js/script.min.43228034bf2ab22536ef180053db824d50bb5944029d13dbe5249d3450e87d26.js></script><script defer async crossorigin=anonymous integrity="sha256-w+aS42D2+B+Jix+joZ7pAua1vbu/pRK/IhoP55b8n3w=" src=/js/script-lazy.min.c3e692e360f6f81f898b1fa3a19ee902e6b5bdbbbfa512bf221a0fe796fc9f7c.js></script><script>"serviceWorker"in navigator&&navigator.serviceWorker.register("/service-worker.js")</script><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-M9N2K2MX" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript></body></html>